
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://re-meta.github.io/api/gendata/">
      
      
        <link rel="prev" href="../plot/">
      
      
        <link rel="next" href="../configuration/">
      
      
        
      
      
      <link rel="icon" href="../img/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Simulation - ReMeta API</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#remetagendata" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ReMeta API" class="md-header__button md-logo" aria-label="ReMeta API" data-md-component="logo">
      
  <img src="../img/logo_api.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ReMeta API
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Simulation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/coconeuro/remeta" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg width="1024" height="1024" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" transform="scale(64)" fill="#1B1F23"/>
</svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ReMeta API" class="md-nav__button md-logo" aria-label="ReMeta API" data-md-component="logo">
      
  <img src="../img/logo_api.png" alt="logo">

    </a>
    ReMeta API
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/coconeuro/remeta" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg width="1024" height="1024" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" transform="scale(64)" fill="#1B1F23"/>
</svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://re-meta.github.io" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    → Guide ⮺
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plotting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Simulation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Simulation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.TAB" class="md-nav__link">
    <span class="md-ellipsis">
      
        TAB
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.m" class="md-nav__link">
    <span class="md-ellipsis">
      
        m
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.options" class="md-nav__link">
    <span class="md-ellipsis">
      
        options
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.params" class="md-nav__link">
    <span class="md-ellipsis">
      
        params
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.Configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.Configuration--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.Simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simulation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata._check_param" class="md-nav__link">
    <span class="md-ellipsis">
      
        _check_param
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.check_criteria_sum" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_criteria_sum
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_criteria_sum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.check_criteria_sum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.check_criteria_sum--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.compute_nonlinear_encoding" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_nonlinear_encoding
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.compute_signal_dependent_type1_noise" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_signal_dependent_type1_noise
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_signal_dependent_type1_noise">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.compute_signal_dependent_type1_noise--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.compute_signal_dependent_type1_noise--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.discretize_confidence_with_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      
        discretize_confidence_with_bounds
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.generate_stimuli" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_stimuli
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.get_type2_dist" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_type2_dist
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_type2_dist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.get_type2_dist--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.get_type2_dist--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.print_dataset_characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      
        print_dataset_characteristics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.simu_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        simu_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.simu_type1_responses" class="md-nav__link">
    <span class="md-ellipsis">
      
        simu_type1_responses
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.type1_evidence_to_confidence" class="md-nav__link">
    <span class="md-ellipsis">
      
        type1_evidence_to_confidence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type1_evidence_to_confidence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.type1_evidence_to_confidence--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.type1_evidence_to_confidence--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.type2_SDT_MLE" class="md-nav__link">
    <span class="md-ellipsis">
      
        type2_SDT_MLE
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.type2roc" class="md-nav__link">
    <span class="md-ellipsis">
      
        type2roc
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.TAB" class="md-nav__link">
    <span class="md-ellipsis">
      
        TAB
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.m" class="md-nav__link">
    <span class="md-ellipsis">
      
        m
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.options" class="md-nav__link">
    <span class="md-ellipsis">
      
        options
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.params" class="md-nav__link">
    <span class="md-ellipsis">
      
        params
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.Configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.Configuration--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.Simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simulation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata._check_param" class="md-nav__link">
    <span class="md-ellipsis">
      
        _check_param
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.check_criteria_sum" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_criteria_sum
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_criteria_sum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.check_criteria_sum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.check_criteria_sum--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.compute_nonlinear_encoding" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_nonlinear_encoding
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.compute_signal_dependent_type1_noise" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_signal_dependent_type1_noise
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_signal_dependent_type1_noise">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.compute_signal_dependent_type1_noise--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.compute_signal_dependent_type1_noise--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.discretize_confidence_with_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      
        discretize_confidence_with_bounds
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.generate_stimuli" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_stimuli
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.get_type2_dist" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_type2_dist
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_type2_dist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.get_type2_dist--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.get_type2_dist--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.print_dataset_characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      
        print_dataset_characteristics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.simu_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        simu_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.simu_type1_responses" class="md-nav__link">
    <span class="md-ellipsis">
      
        simu_type1_responses
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.type1_evidence_to_confidence" class="md-nav__link">
    <span class="md-ellipsis">
      
        type1_evidence_to_confidence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type1_evidence_to_confidence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.type1_evidence_to_confidence--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remeta.gendata.type1_evidence_to_confidence--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.type2_SDT_MLE" class="md-nav__link">
    <span class="md-ellipsis">
      
        type2_SDT_MLE
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remeta.gendata.type2roc" class="md-nav__link">
    <span class="md-ellipsis">
      
        type2roc
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="remetagendata">remeta.gendata</h1>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="remeta.gendata.TAB" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">TAB</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">TAB</span> <span class="o">=</span> <span class="s1">&#39;    &#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="remeta.gendata.m" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">m</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">m</span> <span class="o">=</span> <span class="n">simu_data</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">nsubjects</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="remeta.gendata.options" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">options</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">meta_noise_type</span><span class="o">=</span><span class="s1">&#39;noisy_report&#39;</span><span class="p">,</span> <span class="n">enable_type1_param_thresh</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">enable_type1_param_bias</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">enable_type2_param_evidence_bias_mult</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">type2_noise_dist</span><span class="o">=</span><span class="s1">&#39;beta_mode&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="remeta.gendata.params" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">params</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">type1_noise</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">type1_thresh</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">type1_bias</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">type2_noise</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-class">



<h2 id="remeta.gendata.Configuration" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Configuration</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">



        <p>Configuration for the ReMeta toolbox</p>
<h4 id="remeta.gendata.Configuration--parameters">Parameters</h4>
<p>*** Basic definition of the model ***
type2_fitting_type : str (default: 'criteria')
    Whether confidence is fitted with discrete <em>criteria</em> or as a continuous variable.
    Possible values: 'criteria', 'continuous'
type2_noise_type : str (default: 'noisy-report)
    Whether the model considers noise at readout or report.
    Possible values: 'noisy_report', 'noisy_readout', 'noisy_temperature'
type2_noise_dist : str
        (default: noisy-report + criteria -&gt; 'truncated_norm_mode'
                  noisy-report + continuous -&gt; 'truncated_norm_mode'
                  noisy-readout + criteria -&gt; 'truncated_norm_mode'
                  noisy-readout + continuous -&gt; 'truncated_norm_mode'
                  noisy-temperature + criteria -&gt; 'lognorm_mode'
                  noisy-temperature + continuous -&gt; 'truncated_norm_mode'
        )
    Metacognitive noise distribution.
    Possible values:
        noisy_report: 'beta_mean_std', 'beta_mode_std', 'beta_mode',
                      'truncated_norm_mode_std', 'truncated_norm_mode' (default),
                      'truncated_gumbel_mode_std', 'truncated_gumbel_mode',
                      'truncated_lognorm_mode_std', 'truncated_lognorm', 'truncated_lognorm_mode',
                      'truncated_lognorm_mean'
        noisy_readout: 'lognorm_median_std', 'lognorm_mean', 'lognorm_mode', 'lognorm_mode_std', 'lognorm_mean_std',
                       'gamma_mode_std', 'gamma_mean_std', 'gamma_mean', 'gamma_mode', 'gamma_mean_cv',
                       'betaprime_mean_std',
                       'truncated_norm_mode_std', 'truncated_norm_mode',
                       'truncated_gumbel_mode_std', 'truncated_gumbel_mode'
        noisy_temperature: same as noisy_readout</p>
<p>*** Enable or disable specific parameters ***
* Each setting can take the values 0, 1 or 2:
*    0: Disable parameter.
*    1: Enable parameter.
*    2: Enable parameter and fit separate values for the negative and positive stimulus category
        (works only for type 1 parameters!)
enable_type1_param_noise : int (default: 1)
    Fit separate type 1 noise parameters for both stimulus categories.
enable_type1_param_noise_heteroscedastic : int (default: 0)
    Fit an additional type 1 noise parameter for signal-dependent type 1 noise (the type of dependency is
    defined via <code>type1_noise_signal_dependency</code>).
enable_type1_param_nonlinear_encoding_gain : int (default: 0)
enable_type1_param_nonlinear_encoding_transition : int (default: 0)
enable_type1_param_thresh : int (default: 0)
    Fit a type 1 threshold.
enable_type1_param_bias : int (default: 1)
    Fit a type 1 bias towards one of the stimulus categories.
enable_type2_param_noise : int (default: 1)
    Fit a metacognitive noise parameter
enable_type2_param_evidence_bias_mult : int (default: 0)
    Fit a multiplicative metacognitive bias loading on evidence.
enable_type2_param_criteria : int (default: 0)
    Fit confidence criteria.</p>
<p>*** Additional options to specify the nature of type 2 fitting ***
n_discrete_confidence_levels : int (default: 5)
    Number of confidence criteria. Only applies in case of type2_fitting_type='criteria'.</p>
<p>*** Define fitting characteristics of the parameters ***
* The fitting of each parameter is characzerized as follows:
*     1) An initial guess.
*     2) Lower and upper bound.
*     3) Grid range, i.e. list of values that are tested during the initial gridsearch search.
* Sensible default values are provided for all parameters. To tweak those, one can either define an entire
* ParameterSet, which is a container for a set of parameters, or each parameter individually. Note that the
* parameters must be either defined as a Parameter instance or as List[Parameter] in case when separate values are
* fitted for the positive and negative stimulus category/decision value).
paramset_type1 : ParameterSet
    Parameter set for the type 1 stage.
paramset_type2 : ParameterSet
    Parameter set for the type 2 stage.
paramset : ParameterSet
    Parameter set for both stages.</p>


<details class="_type1_param_noise-" open>
  <summary>Union[Parameter, List[Parameter]]  (default: 1)</summary>
  <p>Parameter for type 1 noise.</p>
</details>        <p>_type1_param_noise_heteroscedastic : Union[Parameter, List[Parameter]]  (default: 0)
    Parameter for signal-dependent type 1 noise.
_type1_param_nonlinear_encoding_gain : Union[Parameter, List[Parameter]]  (default: 0)
    Gain parameter for nonlinear encoding (higher values -&gt; stronger nonlinearity).
_type1_param_nonlinear_encoding_transition : Union[Parameter, List[Parameter]]  (default: 0)
    Transition Parameter for nonlinear encoding ().
type1_noise_signal_dependency: str (default: 'none')
    Can be one of 'none', 'multiplicative', 'power', 'exponential' or 'logarithm'.
_type1_param_thresh : Union[Parameter, List[Parameter]] (default: 0)
    Parameter for the type 1 threshold.
_type1_param_bias : Union[Parameter, List[Parameter]]  (default: 1)
    Parameter for the type 1 bias.
_type2_param_noise : Union[Parameter, List[Parameter]]  (default: 1)
    Parameter for metacognitive noise.
_type2_param_evidence_bias_mult : Union[Parameter, List[Parameter]]  (default: 0)
    Parameter for a multiplicative metacognitive bias loading on evidence.
type2_param_confidence_criteria : List[Parameter]  (default: 1)
    List of parameter specifying the confidence criteria.</p>
<p>*** Skip type 2 fitting ***
skip_type2 : bool (default: False)
    If True, ignore type 2 settings in the setup of the model configuration &amp; don't fit type 2 stage.</p>
<p>*** Methodoligcal aspects of parameter fitting ***
optim_type1_gridsearch : bool (default: False)
    If True, perform initial (usually coarse) gridsearch search for type 1 fitting, based on the gridsearch defined
    for a Parameter.
optim_type1_fine_gridsearch : bool (default: False)
    If True, perform an iteratively finer gridsearch search for each parameter (type 1).
optim_type1_minimize_along_grid : bool (default: False)
    If True, do sqlqp minimization for at each grid point (type 1).
optim_type1_global_minimization : str (default: None)
    Use one of 'shgo', 'dual_annealing' 'differential_evolution' to start likelihood minimization with
    a global minimizer (type 1).
optim_type1_scipy_solvers : str or Tuple/List (default: 'trust-constr')
    Set scipy.optimize.minimize gradient method (type 1)
    If provided as Tuple/List, test different gradient methods and take the best
optim_type2_gridsearch : bool (default: True)
    If True, perform initial (usually coarse) gridsearch search for type 2 fitting, based on the gridsearch defined
    for a Parameter.
optim_type2_fine_gridsearch : bool (default: False)
    If True, perform an iteratively finer gridsearch search for each parameter (type 2).
optim_type2_minimize_along_grid : bool (default: False)
    If True, do sqlqp minimization for at each grid point (type 2).
optim_type2_global_minimization : str (default: None)
    Use one of 'shgo', 'dual_annealing' 'differential_evolution' to start likelihood minimization with
    a global minimizer (type 2).
optim_type2_scipy_solvers : str or Tuple/List (default: ('slsqp', 'Nelder-Mead'))
    Set scipy.optimize.minimize gradient method (type 2)
    If provided as Tuple/List, test different gradient methods and take the best
optim_type2_slsqp_epsilon : float or Tuple/List (default: None)
    Set parameter epsilon parameter for the SLSQP optimization method (type 2).
    If provided as Tuple/List, test different eps parameters and take the best
optim_multiproc : bool (default: False)
    If True, use all optim_multiproc_cores cores for parameter estimation. If False, use a single core.
optim_multiproc_cores : int (default: -1)
    If multicore processing es enabled via optim_multiproc, use optim_multiproc_cores cores for parameter estimation
    (-1 for all cores minus 1).</p>
<p>*** Preprocessing ***
normalize_stimuli_by_max : bool (default: True)
    If True, normalize provided stimuli by their maximum value.</p>
<p>*** Parameters for the type 2 likelihood computation ***
min_type1_likelihood : float
    Minimum probability used during the type 1 likelihood computation
min_type2_likelihood : float
    Minimum probability used during the type 2 likelihood computation
type2_binsize : float
    Integration bin size for the computation of the likelihood around empirical confidence values
y_decval_range_nsds : int
    Number of standard deviations around the mean considered for type 1 uncertainty.
y_decval_range_nbins : int
    Number of discrete decision values bins that are considered to represent type 1 uncertainty.
resolution_noisy_temperature : float
    Quintile resolution for the marginalization of type 1 noise in case of type2_noise_type 'noisy_temperature'.
experimental_min_uniform_type2_likelihood : bool
    Instead of using a minimum probability during the likelihood computation, use a maximum cumulative
    likelihood based on a 'guessing' model
experimental_wrap_type2_integration_window : bool (default: False)
    Ensure constant window size for likelihood integration at the bounds.
    Only applies in case of type2_fitting_type='continuous' and experimental_disable_type2_binsize=False
experimental_include_incongruent_y_decval : bool (default: False)
    Include incongruent decision values (i.e., sign(actual choice) != sign(decision value)) for the likelihood
    computation
experimental_disable_type2_binsize : bool (default: None)
    Do not use an integegration window for likelihood computation.
    Only applies in case of type2_fitting_type='continuous'</p>
<p>*** Other ***
true_params : Dict
    Pass true (known) parameter values. This can be useful for testing to compare the likelihood of true and
    fitted parameters. The likelihood of true parameters is returned (and printed).
initilialize_fitting_at_true_params : bool (default: False)
    Option to initialize the parameter fitting procedure at the true parameters; this can be helpful for testing.
silence_configuration_warnings : bool (default: False)
    If True, ignore warnings about user-specified settings.
print_configuration : bool (default: True)
    If True, print the configuration at instatiation of the ReMeta class.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>remeta/configuration.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@reset_dataclass_on_init</span>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Configuration</span><span class="p">(</span><span class="n">ReprMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for the ReMeta toolbox</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *** Basic definition of the model ***</span>
<span class="sd">    type2_fitting_type : str (default: &#39;criteria&#39;)</span>
<span class="sd">        Whether confidence is fitted with discrete *criteria* or as a continuous variable.</span>
<span class="sd">        Possible values: &#39;criteria&#39;, &#39;continuous&#39;</span>
<span class="sd">    type2_noise_type : str (default: &#39;noisy-report)</span>
<span class="sd">        Whether the model considers noise at readout or report.</span>
<span class="sd">        Possible values: &#39;noisy_report&#39;, &#39;noisy_readout&#39;, &#39;noisy_temperature&#39;</span>
<span class="sd">    type2_noise_dist : str</span>
<span class="sd">            (default: noisy-report + criteria -&gt; &#39;truncated_norm_mode&#39;</span>
<span class="sd">                      noisy-report + continuous -&gt; &#39;truncated_norm_mode&#39;</span>
<span class="sd">                      noisy-readout + criteria -&gt; &#39;truncated_norm_mode&#39;</span>
<span class="sd">                      noisy-readout + continuous -&gt; &#39;truncated_norm_mode&#39;</span>
<span class="sd">                      noisy-temperature + criteria -&gt; &#39;lognorm_mode&#39;</span>
<span class="sd">                      noisy-temperature + continuous -&gt; &#39;truncated_norm_mode&#39;</span>
<span class="sd">            )</span>
<span class="sd">        Metacognitive noise distribution.</span>
<span class="sd">        Possible values:</span>
<span class="sd">            noisy_report: &#39;beta_mean_std&#39;, &#39;beta_mode_std&#39;, &#39;beta_mode&#39;,</span>
<span class="sd">                          &#39;truncated_norm_mode_std&#39;, &#39;truncated_norm_mode&#39; (default),</span>
<span class="sd">                          &#39;truncated_gumbel_mode_std&#39;, &#39;truncated_gumbel_mode&#39;,</span>
<span class="sd">                          &#39;truncated_lognorm_mode_std&#39;, &#39;truncated_lognorm&#39;, &#39;truncated_lognorm_mode&#39;,</span>
<span class="sd">                          &#39;truncated_lognorm_mean&#39;</span>
<span class="sd">            noisy_readout: &#39;lognorm_median_std&#39;, &#39;lognorm_mean&#39;, &#39;lognorm_mode&#39;, &#39;lognorm_mode_std&#39;, &#39;lognorm_mean_std&#39;,</span>
<span class="sd">                           &#39;gamma_mode_std&#39;, &#39;gamma_mean_std&#39;, &#39;gamma_mean&#39;, &#39;gamma_mode&#39;, &#39;gamma_mean_cv&#39;,</span>
<span class="sd">                           &#39;betaprime_mean_std&#39;,</span>
<span class="sd">                           &#39;truncated_norm_mode_std&#39;, &#39;truncated_norm_mode&#39;,</span>
<span class="sd">                           &#39;truncated_gumbel_mode_std&#39;, &#39;truncated_gumbel_mode&#39;</span>
<span class="sd">            noisy_temperature: same as noisy_readout</span>


<span class="sd">    *** Enable or disable specific parameters ***</span>
<span class="sd">    * Each setting can take the values 0, 1 or 2:</span>
<span class="sd">    *    0: Disable parameter.</span>
<span class="sd">    *    1: Enable parameter.</span>
<span class="sd">    *    2: Enable parameter and fit separate values for the negative and positive stimulus category</span>
<span class="sd">            (works only for type 1 parameters!)</span>
<span class="sd">    enable_type1_param_noise : int (default: 1)</span>
<span class="sd">        Fit separate type 1 noise parameters for both stimulus categories.</span>
<span class="sd">    enable_type1_param_noise_heteroscedastic : int (default: 0)</span>
<span class="sd">        Fit an additional type 1 noise parameter for signal-dependent type 1 noise (the type of dependency is</span>
<span class="sd">        defined via `type1_noise_signal_dependency`).</span>
<span class="sd">    enable_type1_param_nonlinear_encoding_gain : int (default: 0)</span>
<span class="sd">    enable_type1_param_nonlinear_encoding_transition : int (default: 0)</span>
<span class="sd">    enable_type1_param_thresh : int (default: 0)</span>
<span class="sd">        Fit a type 1 threshold.</span>
<span class="sd">    enable_type1_param_bias : int (default: 1)</span>
<span class="sd">        Fit a type 1 bias towards one of the stimulus categories.</span>
<span class="sd">    enable_type2_param_noise : int (default: 1)</span>
<span class="sd">        Fit a metacognitive noise parameter</span>
<span class="sd">    enable_type2_param_evidence_bias_mult : int (default: 0)</span>
<span class="sd">        Fit a multiplicative metacognitive bias loading on evidence.</span>
<span class="sd">    enable_type2_param_criteria : int (default: 0)</span>
<span class="sd">        Fit confidence criteria.</span>

<span class="sd">    *** Additional options to specify the nature of type 2 fitting ***</span>
<span class="sd">    n_discrete_confidence_levels : int (default: 5)</span>
<span class="sd">        Number of confidence criteria. Only applies in case of type2_fitting_type=&#39;criteria&#39;.</span>

<span class="sd">    *** Define fitting characteristics of the parameters ***</span>
<span class="sd">    * The fitting of each parameter is characzerized as follows:</span>
<span class="sd">    *     1) An initial guess.</span>
<span class="sd">    *     2) Lower and upper bound.</span>
<span class="sd">    *     3) Grid range, i.e. list of values that are tested during the initial gridsearch search.</span>
<span class="sd">    * Sensible default values are provided for all parameters. To tweak those, one can either define an entire</span>
<span class="sd">    * ParameterSet, which is a container for a set of parameters, or each parameter individually. Note that the</span>
<span class="sd">    * parameters must be either defined as a Parameter instance or as List[Parameter] in case when separate values are</span>
<span class="sd">    * fitted for the positive and negative stimulus category/decision value).</span>
<span class="sd">    paramset_type1 : ParameterSet</span>
<span class="sd">        Parameter set for the type 1 stage.</span>
<span class="sd">    paramset_type2 : ParameterSet</span>
<span class="sd">        Parameter set for the type 2 stage.</span>
<span class="sd">    paramset : ParameterSet</span>
<span class="sd">        Parameter set for both stages.</span>

<span class="sd">    _type1_param_noise : Union[Parameter, List[Parameter]]  (default: 1)</span>
<span class="sd">        Parameter for type 1 noise.</span>
<span class="sd">    _type1_param_noise_heteroscedastic : Union[Parameter, List[Parameter]]  (default: 0)</span>
<span class="sd">        Parameter for signal-dependent type 1 noise.</span>
<span class="sd">    _type1_param_nonlinear_encoding_gain : Union[Parameter, List[Parameter]]  (default: 0)</span>
<span class="sd">        Gain parameter for nonlinear encoding (higher values -&gt; stronger nonlinearity).</span>
<span class="sd">    _type1_param_nonlinear_encoding_transition : Union[Parameter, List[Parameter]]  (default: 0)</span>
<span class="sd">        Transition Parameter for nonlinear encoding ().</span>
<span class="sd">    type1_noise_signal_dependency: str (default: &#39;none&#39;)</span>
<span class="sd">        Can be one of &#39;none&#39;, &#39;multiplicative&#39;, &#39;power&#39;, &#39;exponential&#39; or &#39;logarithm&#39;.</span>
<span class="sd">    _type1_param_thresh : Union[Parameter, List[Parameter]] (default: 0)</span>
<span class="sd">        Parameter for the type 1 threshold.</span>
<span class="sd">    _type1_param_bias : Union[Parameter, List[Parameter]]  (default: 1)</span>
<span class="sd">        Parameter for the type 1 bias.</span>
<span class="sd">    _type2_param_noise : Union[Parameter, List[Parameter]]  (default: 1)</span>
<span class="sd">        Parameter for metacognitive noise.</span>
<span class="sd">    _type2_param_evidence_bias_mult : Union[Parameter, List[Parameter]]  (default: 0)</span>
<span class="sd">        Parameter for a multiplicative metacognitive bias loading on evidence.</span>
<span class="sd">    type2_param_confidence_criteria : List[Parameter]  (default: 1)</span>
<span class="sd">        List of parameter specifying the confidence criteria.</span>

<span class="sd">    *** Skip type 2 fitting ***</span>
<span class="sd">    skip_type2 : bool (default: False)</span>
<span class="sd">        If True, ignore type 2 settings in the setup of the model configuration &amp; don&#39;t fit type 2 stage.</span>

<span class="sd">    *** Methodoligcal aspects of parameter fitting ***</span>
<span class="sd">    optim_type1_gridsearch : bool (default: False)</span>
<span class="sd">        If True, perform initial (usually coarse) gridsearch search for type 1 fitting, based on the gridsearch defined</span>
<span class="sd">        for a Parameter.</span>
<span class="sd">    optim_type1_fine_gridsearch : bool (default: False)</span>
<span class="sd">        If True, perform an iteratively finer gridsearch search for each parameter (type 1).</span>
<span class="sd">    optim_type1_minimize_along_grid : bool (default: False)</span>
<span class="sd">        If True, do sqlqp minimization for at each grid point (type 1).</span>
<span class="sd">    optim_type1_global_minimization : str (default: None)</span>
<span class="sd">        Use one of &#39;shgo&#39;, &#39;dual_annealing&#39; &#39;differential_evolution&#39; to start likelihood minimization with</span>
<span class="sd">        a global minimizer (type 1).</span>
<span class="sd">    optim_type1_scipy_solvers : str or Tuple/List (default: &#39;trust-constr&#39;)</span>
<span class="sd">        Set scipy.optimize.minimize gradient method (type 1)</span>
<span class="sd">        If provided as Tuple/List, test different gradient methods and take the best</span>
<span class="sd">    optim_type2_gridsearch : bool (default: True)</span>
<span class="sd">        If True, perform initial (usually coarse) gridsearch search for type 2 fitting, based on the gridsearch defined</span>
<span class="sd">        for a Parameter.</span>
<span class="sd">    optim_type2_fine_gridsearch : bool (default: False)</span>
<span class="sd">        If True, perform an iteratively finer gridsearch search for each parameter (type 2).</span>
<span class="sd">    optim_type2_minimize_along_grid : bool (default: False)</span>
<span class="sd">        If True, do sqlqp minimization for at each grid point (type 2).</span>
<span class="sd">    optim_type2_global_minimization : str (default: None)</span>
<span class="sd">        Use one of &#39;shgo&#39;, &#39;dual_annealing&#39; &#39;differential_evolution&#39; to start likelihood minimization with</span>
<span class="sd">        a global minimizer (type 2).</span>
<span class="sd">    optim_type2_scipy_solvers : str or Tuple/List (default: (&#39;slsqp&#39;, &#39;Nelder-Mead&#39;))</span>
<span class="sd">        Set scipy.optimize.minimize gradient method (type 2)</span>
<span class="sd">        If provided as Tuple/List, test different gradient methods and take the best</span>
<span class="sd">    optim_type2_slsqp_epsilon : float or Tuple/List (default: None)</span>
<span class="sd">        Set parameter epsilon parameter for the SLSQP optimization method (type 2).</span>
<span class="sd">        If provided as Tuple/List, test different eps parameters and take the best</span>
<span class="sd">    optim_multiproc : bool (default: False)</span>
<span class="sd">        If True, use all optim_multiproc_cores cores for parameter estimation. If False, use a single core.</span>
<span class="sd">    optim_multiproc_cores : int (default: -1)</span>
<span class="sd">        If multicore processing es enabled via optim_multiproc, use optim_multiproc_cores cores for parameter estimation</span>
<span class="sd">        (-1 for all cores minus 1).</span>

<span class="sd">    *** Preprocessing ***</span>
<span class="sd">    normalize_stimuli_by_max : bool (default: True)</span>
<span class="sd">        If True, normalize provided stimuli by their maximum value.</span>

<span class="sd">    *** Parameters for the type 2 likelihood computation ***</span>
<span class="sd">    min_type1_likelihood : float</span>
<span class="sd">        Minimum probability used during the type 1 likelihood computation</span>
<span class="sd">    min_type2_likelihood : float</span>
<span class="sd">        Minimum probability used during the type 2 likelihood computation</span>
<span class="sd">    type2_binsize : float</span>
<span class="sd">        Integration bin size for the computation of the likelihood around empirical confidence values</span>
<span class="sd">    y_decval_range_nsds : int</span>
<span class="sd">        Number of standard deviations around the mean considered for type 1 uncertainty.</span>
<span class="sd">    y_decval_range_nbins : int</span>
<span class="sd">        Number of discrete decision values bins that are considered to represent type 1 uncertainty.</span>
<span class="sd">    resolution_noisy_temperature : float</span>
<span class="sd">        Quintile resolution for the marginalization of type 1 noise in case of type2_noise_type &#39;noisy_temperature&#39;.</span>
<span class="sd">    experimental_min_uniform_type2_likelihood : bool</span>
<span class="sd">        Instead of using a minimum probability during the likelihood computation, use a maximum cumulative</span>
<span class="sd">        likelihood based on a &#39;guessing&#39; model</span>
<span class="sd">    experimental_wrap_type2_integration_window : bool (default: False)</span>
<span class="sd">        Ensure constant window size for likelihood integration at the bounds.</span>
<span class="sd">        Only applies in case of type2_fitting_type=&#39;continuous&#39; and experimental_disable_type2_binsize=False</span>
<span class="sd">    experimental_include_incongruent_y_decval : bool (default: False)</span>
<span class="sd">        Include incongruent decision values (i.e., sign(actual choice) != sign(decision value)) for the likelihood</span>
<span class="sd">        computation</span>
<span class="sd">    experimental_disable_type2_binsize : bool (default: None)</span>
<span class="sd">        Do not use an integegration window for likelihood computation.</span>
<span class="sd">        Only applies in case of type2_fitting_type=&#39;continuous&#39;</span>


<span class="sd">    *** Other ***</span>
<span class="sd">    true_params : Dict</span>
<span class="sd">        Pass true (known) parameter values. This can be useful for testing to compare the likelihood of true and</span>
<span class="sd">        fitted parameters. The likelihood of true parameters is returned (and printed).</span>
<span class="sd">    initilialize_fitting_at_true_params : bool (default: False)</span>
<span class="sd">        Option to initialize the parameter fitting procedure at the true parameters; this can be helpful for testing.</span>
<span class="sd">    silence_configuration_warnings : bool (default: False)</span>
<span class="sd">        If True, ignore warnings about user-specified settings.</span>
<span class="sd">    print_configuration : bool (default: True)</span>
<span class="sd">        If True, print the configuration at instatiation of the ReMeta class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">type2_fitting_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;criteria&#39;</span>
    <span class="n">type2_noise_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;noisy_report&#39;</span>
    <span class="n">type2_noise_dist</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># noisy-report + criteria -&gt; &#39;truncated_norm_mode&#39;</span>
        <span class="c1"># noisy-report + continuous -&gt; &#39;truncated_norm_mode&#39;</span>
        <span class="c1"># noisy-readout + criteria -&gt; &#39;truncated_norm_mode&#39;</span>
        <span class="c1"># noisy-readout + continuous -&gt; &#39;truncated_norm_mode&#39;</span>
        <span class="c1"># noisy-temperature + criteria -&gt; &#39;lognorm_mode&#39;</span>
        <span class="c1"># noisy-temperature + continuous -&gt; &#39;truncated_norm_mode&#39;</span>

    <span class="n">enable_type1_param_noise</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">enable_type1_param_thresh</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">enable_type1_param_bias</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">enable_type2_param_noise</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">enable_type2_param_evidence_bias_mult</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">enable_type2_param_criteria</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># Experimental:</span>
    <span class="n">enable_type1_param_noise_heteroscedastic</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">enable_type1_param_nonlinear_encoding_gain</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">enable_type1_param_nonlinear_encoding_transition</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">n_discrete_confidence_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="n">paramset_type1</span><span class="p">:</span> <span class="n">ParameterSet</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">paramset_type2</span><span class="p">:</span> <span class="n">ParameterSet</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">paramset_all</span><span class="p">:</span> <span class="n">ParameterSet</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">type1_param_noise_heteroscedastic</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">guess</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">grid_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">type1_param_nonlinear_encoding_gain</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">guess</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">grid_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">type1_param_nonlinear_encoding_transition</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">guess</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">grid_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">type1_param_noise</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">guess</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">grid_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">type1_param_thresh</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">guess</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">grid_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">type1_param_bias</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">guess</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">grid_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">type2_param_noise</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">guess</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">grid_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">type2_param_evidence_bias_mult</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">guess</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">grid_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">type2_param_criteria</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">type2_param_criteria_guesses</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;equidistant&#39;</span>
    <span class="n">type2_param_criteria_grid_ranges</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;equidistant&#39;</span>

    <span class="n">type1_noise_signal_dependency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>

    <span class="n">skip_type2</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">optim_type1_gridsearch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">optim_type1_fine_gridsearch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">optim_type1_minimize_along_grid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">optim_type1_global_minimization</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_optim_type1_scipy_solvers_default</span> <span class="o">=</span> <span class="s1">&#39;trust-constr&#39;</span>
    <span class="n">optim_type1_scipy_solvers</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;trust-constr&#39;</span>
    <span class="n">optim_type2_gridsearch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">optim_type2_fine_gridsearch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">optim_type2_minimize_along_grid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">optim_type2_global_minimization</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">optim_type2_scipy_solvers</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;slsqp&#39;</span><span class="p">,</span> <span class="s1">&#39;Nelder-Mead&#39;</span><span class="p">)</span>
    <span class="n">optim_type2_slsqp_epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">optim_multiproc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">optim_multiproc_cores</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">_optim_multiproc_cores_effective</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">normalize_stimuli_by_max</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">confidence_bounds_error</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">min_type2_likelihood</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-10</span>
    <span class="n">min_type1_likelihood</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-10</span>
    <span class="n">type2_binsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">y_decval_range_nsds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">y_decval_range_nbins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">101</span>
    <span class="n">resolution_noisy_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span>

    <span class="n">experimental_min_uniform_type2_likelihood</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">experimental_wrap_type2_integration_window</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">experimental_include_incongruent_y_decval</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">experimental_disable_type2_binsize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">true_params</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">initilialize_fitting_at_true_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">silence_configuration_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">print_configuration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">type2_param_noise_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span>

    <span class="c1"># setup_called = False</span>

    <span class="n">_type1_param_noise</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_type1_param_noise_heteroscedastic</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_type1_param_nonlinear_encoding_transition</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_type1_param_nonlinear_encoding_gain</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_type1_param_thresh</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_type1_param_bias</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_type2_param_noise</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_type2_param_evidence_bias_mult</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_type2_param_criteria</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generative_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">find_spec</span><span class="p">(</span><span class="s1">&#39;multiprocessing_on_dill&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Multiprocessing on dill is not installed. Setting grid_multiproc is changed to False.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optim_multiproc</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_multiproc</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">cpu_count</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_optim_multiproc_cores_effective</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">cpu_count</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_multiproc_cores</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> \
                <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_multiproc_cores</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_params_type1</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_type2_slsqp_epsilon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">optim_type2_slsqp_epsilon</span> <span class="o">=</span> <span class="mf">1e-5</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_type1_param_thresh</span> <span class="ow">and</span> \
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optim_type1_scipy_solvers</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optim_type1_scipy_solvers_default</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">optim_type1_scipy_solvers</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;trust-constr&#39;</span><span class="p">,</span> <span class="s1">&#39;Powell&#39;</span><span class="p">)</span>


            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_dist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">generative_mode</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;In generative mode, you need to explicitly specify a type 2 noise distribution.&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_report&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_fitting_type</span> <span class="o">==</span> <span class="s1">&#39;criteria&#39;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_dist</span> <span class="o">=</span> <span class="s1">&#39;truncated_norm_mode&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_dist</span> <span class="o">=</span> <span class="s1">&#39;truncated_norm_mode&#39;</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_readout&#39;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_fitting_type</span> <span class="o">==</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_dist</span> <span class="o">=</span> <span class="s1">&#39;truncated_norm_mode&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_dist</span> <span class="o">=</span> <span class="s1">&#39;truncated_norm_mode&#39;</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_temperature&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_fitting_type</span> <span class="o">==</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_dist</span> <span class="o">=</span> <span class="s1">&#39;lognorm_mode&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_dist</span> <span class="o">=</span> <span class="s1">&#39;truncated_norm_mode&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_params_type2</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optim_type2_slsqp_epsilon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">optim_type2_slsqp_epsilon</span> <span class="o">=</span> <span class="mf">1e-5</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_binsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type2_binsize</span> <span class="o">=</span> <span class="mf">0.01</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_params_all</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_compatibility</span><span class="p">(</span><span class="n">generative_mode</span><span class="o">=</span><span class="n">generative_mode</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_configuration</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
        <span class="c1"># self.setup_called = True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_compatibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generative_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">silence_configuration_warnings</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_type2_param_noise</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Setting enable_type2_param_noise=False was provided -&gt; type2_param_noise is set to its default value &#39;</span>
                                  <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_type2_param_noise_default</span><span class="si">}</span><span class="s1">). You may change this value via the configuration.&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_temperature&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_param_noise</span><span class="o">.</span><span class="n">default_changed</span> <span class="ow">and</span> \
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_param_noise</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">):</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;You manually changed the lower bound of the type 2 noise parameter for a &#39;</span>
                                  <span class="s1">&#39;noisy-temperature model to a very low value (&lt;1e-5). Be warned that this may result &#39;</span>
                                  <span class="s1">&#39;in numerical instabilities that severely distort the likelihood computation.&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">generative_mode</span><span class="p">:</span>
                    <span class="c1"># If the configuration instance is used for generating data, we should not complain</span>
                    <span class="c1"># about fitting issues.</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_type2_param_criteria</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_type2_param_evidence_bias_mult</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="s1">&#39;enable_type2_param_criteria=True in combination with enable_type2_param_evidence_bias_mult=True</span><span class="se">\n</span><span class="s1">&#39;</span>
                            <span class="s1">&#39;can lead to biased parameter inferences. Use with caution.&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_fitting_type</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_type2_param_criteria</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Setting type2_fitting_type=&#39;continuous&#39; conflicts with enable_type2_param_criteria=1.&#39;&quot;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_fitting_type</span> <span class="o">==</span> <span class="s1">&#39;criteria&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_type2_param_criteria</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;You selected type2_fitting_type=&#39;criteria&#39;, but did not enable type 2 criteria</span><span class="se">\n</span><span class="s2">&quot;</span>
                                      <span class="s2">&quot;(enable_type2_param_criteria=0). This works, but be mindful that the model</span><span class="se">\n</span><span class="s2">&quot;</span>
                                      <span class="s2">&quot;will assume equispaced ideal Bayesian observer criteria (respecting </span><span class="se">\n</span><span class="s2">&quot;</span>
                                      <span class="s2">&quot;the setting n_discrete_confidence_levels).&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_params_type1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># if self.paramset_type1 is None:</span>

            <span class="n">param_names_type1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">params_type1</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;noise&#39;</span><span class="p">,</span> <span class="s1">&#39;noise_heteroscedastic&#39;</span><span class="p">,</span> <span class="s1">&#39;nonlinear_encoding_gain&#39;</span><span class="p">,</span> <span class="s1">&#39;nonlinear_encoding_transition&#39;</span><span class="p">,</span> <span class="s1">&#39;thresh&#39;</span><span class="p">,</span> <span class="s1">&#39;bias&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_type1</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;enable_type1_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
                    <span class="n">param_names_type1</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;type1_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_type1_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">param_definition</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;type1_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;enable_type1_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_type1_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">param_definition</span><span class="p">,</span> <span class="n">param_definition</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_type1_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">param_definition</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">initilialize_fitting_at_true_params</span> <span class="ow">and</span> <span class="sa">f</span><span class="s1">&#39;type1_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">:</span>
                            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_type1_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">guess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;type1_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>

            <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_type1_param_</span><span class="si">{</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;type1_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">param_names_type1</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paramset_type1</span> <span class="o">=</span> <span class="n">ParameterSet</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">param_names_type1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_params_type2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># if self.paramset_type2 is None:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_type2_param_noise</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type2_param_noise</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_param_noise</span><span class="o">.</span><span class="n">default_changed</span><span class="p">:</span>

                <span class="n">lb</span> <span class="o">=</span> <span class="mf">0.05</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type2_param_noise</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">noisy_report</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">beta_mean_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                        <span class="n">beta_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="p">)),</span>
                        <span class="n">truncated_norm_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="p">)),</span>
                        <span class="n">truncated_gumbel_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="p">)),</span>
                        <span class="n">truncated_lognorm_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">12</span><span class="p">)),</span>
                        <span class="n">beta_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">truncated_norm_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">truncated_gumbel_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">truncated_lognorm_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                        <span class="n">truncated_lognorm_mean</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                        <span class="n">truncated_lognorm</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
                    <span class="p">),</span>
                    <span class="n">noisy_readout</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">lognorm_mean</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">lognorm_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">gamma_mean_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">lognorm_mean_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">lognorm_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">lognorm_median_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">gamma_mean_cv</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">gamma_mean</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">gamma_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">gamma_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">betaprime_mean_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">truncated_norm_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">truncated_norm_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">truncated_gumbel_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">truncated_gumbel_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="p">),</span>
                    <span class="n">noisy_temperature</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">lognorm_mean</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">gamma_mean_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">lognorm_mean_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">lognorm_median_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">gamma_mean_cv</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">gamma_mean</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">gamma_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">gamma_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">betaprime_mean_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">truncated_norm_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">truncated_norm_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">truncated_gumbel_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">truncated_gumbel_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">lognorm_mode</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                        <span class="n">lognorm_mode_std</span><span class="o">=</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_type</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_noise_dist</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type2_param_noise</span><span class="o">.</span><span class="n">grid_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_param_noise</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                                                       <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_param_noise</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">10</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">param_names_type2</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">params_type2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;noise&#39;</span><span class="p">,</span> <span class="s1">&#39;evidence_bias_mult&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_type2</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;enable_type2_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
                    <span class="n">param_names_type2</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;type2_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_type2_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">param_definition</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;type2_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_type2_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">param_definition</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">initilialize_fitting_at_true_params</span> <span class="ow">and</span> <span class="sa">f</span><span class="s1">&#39;type2_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">:</span>
                            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_type2_param_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">guess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;type2_</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>


            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_type2_param_criteria</span><span class="p">:</span>
                <span class="n">param_names_type2</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]</span>
                <span class="n">initialize_true</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initilialize_fitting_at_true_params</span> <span class="ow">and</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;type2_criteria&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_type2_param_criteria&#39;</span><span class="p">,</span>
                        <span class="p">[</span><span class="n">Parameter</span><span class="p">(</span>
                           <span class="n">guess</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">initialize_true</span>
                                    <span class="k">else</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_discrete_confidence_levels</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_param_criteria_guesses</span> <span class="o">==</span> <span class="s1">&#39;equidistant&#39;</span>
                                          <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_param_criteria_guesses</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                           <span class="n">bounds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type2_param_criteria</span><span class="o">.</span><span class="n">bounds</span><span class="p">,</span>
                           <span class="n">grid_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_discrete_confidence_levels</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">if</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">type2_param_criteria_grid_ranges</span> <span class="o">==</span> <span class="s1">&#39;equidistant&#39;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">type2_param_criteria_grid_ranges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="p">)</span>
                         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_discrete_confidence_levels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
                        <span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="c1"># if &#39;type2_criteria&#39; not in self.true_params:</span>
                        <span class="c1">#     raise ValueError(&#39;type2_criteria are missing from cfg.true_params&#39;)</span>
                        <span class="k">if</span> <span class="s1">&#39;type2_criteria&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                                <span class="n">type2_criteria_absolute</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">][:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]))],</span>
                                <span class="n">type2_criteria_bias</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                            <span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">)):</span>
                            <span class="c1"># if &#39;type2_criteria&#39; not in self.true_params[s]:</span>
                            <span class="c1">#     raise ValueError(f&#39;type2_criteria are missing from cfg.true_params (subject {s})&#39;)</span>
                            <span class="k">if</span> <span class="s1">&#39;type2_criteria&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                                    <span class="n">type2_criteria_absolute</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">][:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]))],</span>
                                    <span class="n">type2_criteria_bias</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">true_params</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                                <span class="p">)</span>

            <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_type2_param_</span><span class="si">{</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;type2_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">param_names_type2</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paramset_type2</span> <span class="o">=</span> <span class="n">ParameterSet</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">param_names_type2</span><span class="p">)</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">check_type2_constraints</span><span class="p">()</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_params_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paramset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramset_type1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parameters_all</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">paramset_type1</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">paramset_type2</span><span class="o">.</span><span class="n">parameters</span><span class="p">}</span>
            <span class="n">param_names_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramset_type1</span><span class="o">.</span><span class="n">param_names</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramset_type2</span><span class="o">.</span><span class="n">param_names</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paramset</span> <span class="o">=</span> <span class="n">ParameterSet</span><span class="p">(</span><span class="n">parameters_all</span><span class="p">,</span> <span class="n">param_names_all</span><span class="p">)</span>
            <span class="c1"># for k, attr in self.paramset_type2.__dict__.items():</span>
            <span class="c1">#     attr_old = getattr(self.paramset, k)</span>
            <span class="c1">#     if isinstance(attr, list):</span>
            <span class="c1">#         attr_new = attr_old + attr</span>
            <span class="c1">#     elif isinstance(attr, dict):</span>
            <span class="c1">#         attr_new = {**attr_old, **attr}</span>
            <span class="c1">#     elif isinstance(attr, np.ndarray):</span>
            <span class="c1">#         if attr.ndim == 1:</span>
            <span class="c1">#             attr_new = np.hstack((attr_old, attr))</span>
            <span class="c1">#         else:</span>
            <span class="c1">#             attr_new = np.vstack((attr_old, attr))</span>
            <span class="c1">#     elif isinstance(attr, int):</span>
            <span class="c1">#         attr_new = attr_old + attr</span>
            <span class="c1">#     elif attr is None:</span>
            <span class="c1">#         if attr_old is None:</span>
            <span class="c1">#             attr_new = None</span>
            <span class="c1">#         else:</span>
            <span class="c1">#             raise ValueError(f&#39;Type 2 attribute is None, but type 1 attribute is not.&#39;)</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         raise ValueError(f&#39;Unexpected type {type(attr)}&#39;)</span>
            <span class="c1">#     setattr(self.paramset, k, attr_new)</span>




    <span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># print(&#39;***********************&#39;)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># if not self.skip_type2 or (&#39;type2&#39; not in k):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]))</span>
        <span class="c1"># print(&#39;***********************&#39;)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">return</span> <span class="n">txt</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_type2_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="remeta.gendata.Simulation" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Simulation</span>


</h2>


    <div class="doc doc-contents ">










              <details class="mkdocstrings-source">
                <summary>Source code in <code>remeta/gendata.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Simulation</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsubjects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params_extra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">x_stim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_stim_category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_dec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_decval_latent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_decval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">z1_type1_evidence_latent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z1_type1_evidence_base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z1_type1_evidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">c_conf_latent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_conf_base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_conf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">likelihood_dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type2_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nsubjects</span> <span class="o">=</span> <span class="n">nsubjects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nsamples</span> <span class="o">=</span> <span class="n">nsamples</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_type1</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;type1_&#39;</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_type2</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;type2_&#39;</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_extra</span> <span class="o">=</span> <span class="n">params_extra</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stimuli</span> <span class="o">=</span> <span class="n">x_stim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stimuli_category</span> <span class="o">=</span> <span class="n">x_stim_category</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="n">d_dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accuracy</span> <span class="o">=</span> <span class="n">x_stim_category</span> <span class="o">==</span> <span class="n">d_dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_decval_latent</span> <span class="o">=</span> <span class="n">y_decval_latent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_decval</span> <span class="o">=</span> <span class="n">y_decval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1_type1_evidence_latent</span> <span class="o">=</span> <span class="n">z1_type1_evidence_latent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1_type1_evidence_base</span> <span class="o">=</span> <span class="n">z1_type1_evidence_base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">z1_type1_evidence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_latent</span> <span class="o">=</span> <span class="n">c_conf_latent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_base</span> <span class="o">=</span> <span class="n">c_conf_base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence</span> <span class="o">=</span> <span class="n">c_conf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">likelihood_dist</span> <span class="o">=</span> <span class="n">likelihood_dist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type1_stats</span> <span class="o">=</span> <span class="n">type1_stats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type2_stats</span> <span class="o">=</span> <span class="n">type2_stats</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># for var in (&#39;x_stim&#39;, &#39;x_stim_category&#39;, &#39;d_dec&#39;, &#39;accuracy&#39;):</span>
        <span class="c1">#     if getattr(self, var) is not None:</span>
        <span class="c1">#         setattr(self, var, getattr(self, var).squeeze())</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="remeta.gendata._check_param" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_check_param</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">_check_param</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/util.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_check_param</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Something went wrong, parameter array has length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.check_criteria_sum" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">check_criteria_sum</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_criteria_sum</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ensure that criteria sum up to at most 1</p>
<h4 id="remeta.gendata.check_criteria_sum--parameters">Parameters</h4>
<p>criteria : array-like of dtype float
    Confidence criteria (typically provided as a list)</p>
<h4 id="remeta.gendata.check_criteria_sum--returns">Returns</h4>
<p>criteria : array-like of dtype float
    Transformed confidence criteria</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_criteria_sum</span><span class="p">(</span><span class="n">criteria</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure that criteria sum up to at most 1</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    criteria : array-like of dtype float</span>
<span class="sd">        Confidence criteria (typically provided as a list)</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    criteria : array-like of dtype float</span>
<span class="sd">        Transformed confidence criteria</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ind1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind1</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">criteria</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">criteria</span><span class="p">[</span><span class="n">ind1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">criteria</span><span class="p">[:</span><span class="n">ind1</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">+</span> <span class="mf">1e-8</span>
        <span class="c1"># Note: we add 1e-8 to avoid edge cases due to floating point precision</span>
    <span class="k">return</span> <span class="n">criteria</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.compute_nonlinear_encoding" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">compute_nonlinear_encoding</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_nonlinear_encoding</span><span class="p">(</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">type1_nonlinear_encoding_gain</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_nonlinear_encoding_transition</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_nonlinear_encoding</span><span class="p">(</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">type1_nonlinear_encoding_gain</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_nonlinear_encoding_transition</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="n">gain</span> <span class="o">=</span> <span class="n">_check_param</span><span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">type1_nonlinear_encoding_gain</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">type1_nonlinear_encoding_gain</span><span class="p">)</span>
    <span class="n">transition</span> <span class="o">=</span> <span class="n">_check_param</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">type1_nonlinear_encoding_transition</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">type1_nonlinear_encoding_transition</span><span class="p">)</span>

    <span class="n">neg</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">x_stim</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_stim</span> <span class="o">&gt;=</span> <span class="mi">0</span>
    <span class="n">x_stim_nonlinear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">x_stim</span><span class="p">)</span>
    <span class="n">x_stim_nonlinear</span><span class="p">[</span><span class="n">neg</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_stim</span><span class="p">[</span><span class="n">neg</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">gain</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">neg</span><span class="p">]</span> <span class="o">/</span> <span class="n">transition</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span>
                                           <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">neg</span><span class="p">]</span> <span class="o">/</span> <span class="n">transition</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">x_stim_nonlinear</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_stim</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">gain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">/</span> <span class="n">transition</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span>
                                           <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">/</span> <span class="n">transition</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">x_stim_nonlinear</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.compute_signal_dependent_type1_noise" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">compute_signal_dependent_type1_noise</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_signal_dependent_type1_noise</span><span class="p">(</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">type1_noise</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_thresh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_noise_heteroscedastic</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_noise_signal_dependency</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute signal-dependent type 1 noise.</p>
<h4 id="remeta.gendata.compute_signal_dependent_type1_noise--parameters">Parameters</h4>
<p>x_stim : array-like
    Array of signed stimulus intensity values, where the sign codes the stimulus category and the absolut value
    codes the intensity. Must be normalized to [-1; 1].
type1_noise : float or array-like
    Type 1 noise parameter.
type1_thresh: float or array-like
    Type 1 threshold.
type1_noise_heteroscedastic : float or array-like
    Signal-dependent type 1 noise parameter.
type1_noise_signal_dependency : str
    Define the signal dependency of type 1 noise. One of 'none', 'multiplicative', 'power', 'exponential', 'logarithm'.
kwargs : dict
    Convenience parameter to avoid an error if irrelevant parameters are passed.</p>
<h4 id="remeta.gendata.compute_signal_dependent_type1_noise--returns">Returns</h4>
<p>type1_noise_heteroscedastic : array-like
    Signal-dependent (heteroscedastic) type 1 noise of shape stimuli.shape.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_signal_dependent_type1_noise</span><span class="p">(</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">type1_noise</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_thresh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_noise_heteroscedastic</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                         <span class="n">type1_noise_signal_dependency</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># noqa</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute signal-dependent type 1 noise.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_stim : array-like</span>
<span class="sd">        Array of signed stimulus intensity values, where the sign codes the stimulus category and the absolut value</span>
<span class="sd">        codes the intensity. Must be normalized to [-1; 1].</span>
<span class="sd">    type1_noise : float or array-like</span>
<span class="sd">        Type 1 noise parameter.</span>
<span class="sd">    type1_thresh: float or array-like</span>
<span class="sd">        Type 1 threshold.</span>
<span class="sd">    type1_noise_heteroscedastic : float or array-like</span>
<span class="sd">        Signal-dependent type 1 noise parameter.</span>
<span class="sd">    type1_noise_signal_dependency : str</span>
<span class="sd">        Define the signal dependency of type 1 noise. One of &#39;none&#39;, &#39;multiplicative&#39;, &#39;power&#39;, &#39;exponential&#39;, &#39;logarithm&#39;.</span>
<span class="sd">    kwargs : dict</span>
<span class="sd">        Convenience parameter to avoid an error if irrelevant parameters are passed.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    type1_noise_heteroscedastic : array-like</span>
<span class="sd">        Signal-dependent (heteroscedastic) type 1 noise of shape stimuli.shape.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">type1_noise_</span> <span class="o">=</span> <span class="n">_check_param</span><span class="p">(</span><span class="n">type1_noise</span><span class="p">)</span>
    <span class="n">type1_heteroscedastic_</span> <span class="o">=</span> <span class="n">_check_param</span><span class="p">(</span><span class="n">type1_noise_heteroscedastic</span><span class="p">)</span>
    <span class="n">type1_thresh_</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">type1_thresh</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_check_param</span><span class="p">(</span><span class="n">type1_thresh</span><span class="p">)</span>
    <span class="n">type1_noise_heteroscedastic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">x_stim</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">neg</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">x_stim</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_stim</span> <span class="o">&gt;=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">type1_noise_signal_dependency</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
        <span class="n">type1_noise_heteroscedastic</span><span class="p">[</span><span class="n">neg</span><span class="p">]</span> <span class="o">*=</span> <span class="n">type1_noise_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">type1_noise_heteroscedastic</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">*=</span> <span class="n">type1_noise_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type1_noise_signal_dependency</span> <span class="o">==</span> <span class="s1">&#39;multiplicative&#39;</span><span class="p">:</span>
        <span class="n">type1_noise_heteroscedastic</span><span class="p">[</span><span class="n">neg</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">type1_noise_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                                                         <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">neg</span><span class="p">])</span> <span class="o">-</span> <span class="n">type1_thresh_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">type1_heteroscedastic_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># noqa</span>
        <span class="n">type1_noise_heteroscedastic</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">type1_noise_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                                                         <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span> <span class="o">-</span> <span class="n">type1_thresh_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">type1_heteroscedastic_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">elif</span> <span class="n">type1_noise_signal_dependency</span> <span class="o">==</span> <span class="s1">&#39;power&#39;</span><span class="p">:</span>
        <span class="n">type1_noise_heteroscedastic</span><span class="p">[</span><span class="n">neg</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">type1_noise_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                                                         <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">neg</span><span class="p">])</span> <span class="o">-</span> <span class="n">type1_thresh_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">type1_heteroscedastic_</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># noqa</span>
        <span class="n">type1_noise_heteroscedastic</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">type1_noise_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                                                         <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span> <span class="o">-</span> <span class="n">type1_thresh_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">type1_heteroscedastic_</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># noqa</span>
    <span class="k">elif</span> <span class="n">type1_noise_signal_dependency</span> <span class="o">==</span> <span class="s1">&#39;exponential&#39;</span><span class="p">:</span>
        <span class="n">type1_noise_heteroscedastic</span><span class="p">[</span><span class="n">neg</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">type1_noise_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                                                         <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">type1_heteroscedastic_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">neg</span><span class="p">])</span> <span class="o">-</span> <span class="n">type1_thresh_</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># noqa</span>
        <span class="n">type1_noise_heteroscedastic</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">type1_noise_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                                                         <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">type1_heteroscedastic_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span> <span class="o">-</span> <span class="n">type1_thresh_</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">elif</span> <span class="n">type1_noise_signal_dependency</span> <span class="o">==</span> <span class="s1">&#39;logarithm&#39;</span><span class="p">:</span>
        <span class="n">type1_noise_heteroscedastic</span><span class="p">[</span><span class="n">neg</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">type1_noise_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                                                         <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">type1_heteroscedastic_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">neg</span><span class="p">])</span> <span class="o">-</span> <span class="n">type1_thresh_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># noqa</span>
        <span class="n">type1_noise_heteroscedastic</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">type1_noise_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                                                         <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">type1_heteroscedastic_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_stim</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span> <span class="o">-</span> <span class="n">type1_thresh_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">type1_noise_signal_dependency</span><span class="si">}</span><span class="s1"> is not a valid function for type1_noise_signal_dependency&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">type1_noise_heteroscedastic</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.discretize_confidence_with_bounds" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">discretize_confidence_with_bounds</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">discretize_confidence_with_bounds</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/util.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">discretize_confidence_with_bounds</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bounds</span><span class="p">):</span>
    <span class="n">confidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">bounds</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bounds</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">confidence</span><span class="p">[(</span><span class="n">bounds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">bounds</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">confidence</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.generate_stimuli" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">generate_stimuli</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate_stimuli</span><span class="p">(</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">warn_in_case_of_nondivisible_stepsize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/gendata.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_stimuli</span><span class="p">(</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">warn_in_case_of_nondivisible_stepsize</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">stepsize</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">stepsize</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">warn_in_case_of_nondivisible_stepsize</span> <span class="ow">and</span> <span class="p">((</span><span class="n">nsamples</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">stepsize</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;At the chosen stepsize of </span><span class="si">{</span><span class="n">stepsize</span><span class="si">}</span><span class="s1"> there are </span><span class="si">{</span><span class="mi">2</span><span class="o">/</span><span class="n">stepsize</span><span class="si">}</span><span class="s1"> stimulus levels,&#39;</span>
                      <span class="sa">f</span><span class="s1">&#39;which is not a divisor of the chosen sample size </span><span class="si">{</span><span class="n">nsamples</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="n">x_stim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">nsamples</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)))))[:</span><span class="n">nsamples</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsubjects</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">x_stim</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.get_type2_dist" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_type2_dist</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_type2_dist</span><span class="p">(</span><span class="n">type2_dist</span><span class="p">,</span> <span class="n">type2_center</span><span class="p">,</span> <span class="n">type2_noise</span><span class="p">,</span> <span class="n">type2_noise_type</span><span class="o">=</span><span class="s1">&#39;noisy_report&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Helper function to select appropriately parameterized type 2 noise distributions.</p>
<h4 id="remeta.gendata.get_type2_dist--parameters">Parameters:</h4>
<p>type2_dist : str
    Name of the type 2 noise distribution. Check TYPE2_NOISE_DISTS for possible values.
type2_noise : float or array-like of dtype float
    "True" value of a noisy type 2 variable. Corresponds to type 1 noise (noisy-temperature), metacognitve
    evidence (noisy-readout) or confidence (noisy-report).
    For mean- and mode preserving distributions, the center corresponds to the mean (suffix _mean) and mode (suffix
    _mode), respectively.
type2_noise : float or array-like of dtype float with mode.shape
    Spread parameter that represents metacognitve noise. For standard-deviation-preserving distributions, this
    parameter corresponds to the standard deviation when sampling data from the distribution (suffix _std).
type2_noise_type : str (default='noisy_report')
    Metacognitive noise type. Possible values: 'noisy_report', 'noisy_readout', 'noisy_temperature'.</p>
<h4 id="remeta.gendata.get_type2_dist--returns">Returns:</h4>
<p>scipy.stats continuous distribution instance</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/type2_dist.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_type2_dist</span><span class="p">(</span><span class="n">type2_dist</span><span class="p">,</span> <span class="n">type2_center</span><span class="p">,</span> <span class="n">type2_noise</span><span class="p">,</span> <span class="n">type2_noise_type</span><span class="o">=</span><span class="s1">&#39;noisy_report&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to select appropriately parameterized type 2 noise distributions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    type2_dist : str</span>
<span class="sd">        Name of the type 2 noise distribution. Check TYPE2_NOISE_DISTS for possible values.</span>
<span class="sd">    type2_noise : float or array-like of dtype float</span>
<span class="sd">        &quot;True&quot; value of a noisy type 2 variable. Corresponds to type 1 noise (noisy-temperature), metacognitve</span>
<span class="sd">        evidence (noisy-readout) or confidence (noisy-report).</span>
<span class="sd">        For mean- and mode preserving distributions, the center corresponds to the mean (suffix _mean) and mode (suffix</span>
<span class="sd">        _mode), respectively.</span>
<span class="sd">    type2_noise : float or array-like of dtype float with mode.shape</span>
<span class="sd">        Spread parameter that represents metacognitve noise. For standard-deviation-preserving distributions, this</span>
<span class="sd">        parameter corresponds to the standard deviation when sampling data from the distribution (suffix _std).</span>
<span class="sd">    type2_noise_type : str (default=&#39;noisy_report&#39;)</span>
<span class="sd">        Metacognitive noise type. Possible values: &#39;noisy_report&#39;, &#39;noisy_readout&#39;, &#39;noisy_temperature&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    scipy.stats continuous distribution instance</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">type2_dist</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">TYPE2_NOISE_DISTS</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unkonwn distribution &#39;</span><span class="si">{</span><span class="n">type2_dist</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_report&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">type2_dist</span> <span class="ow">in</span> <span class="n">TYPE2_NOISE_DISTS_READOUT_TEMPERATURE_ONLY</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribution &#39;</span><span class="si">{</span><span class="n">type2_dist</span><span class="si">}</span><span class="s2">&#39; is only valid for noisy-readout or noisy-temperature models.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">type2_noise_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;noisy_readout&#39;</span><span class="p">,</span> <span class="s1">&#39;noisy_temperature&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="n">type2_dist</span> <span class="ow">in</span> <span class="n">TYPE2_NOISE_DISTS_REPORT_ONLY</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribution &#39;</span><span class="si">{</span><span class="n">type2_dist</span><span class="si">}</span><span class="s2">&#39; is only valid for noisy-report models.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">type2_noise</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Type 2 noise is smaller than 1e-10, which can lead to unstable numerical results. It is set&#39;</span>
                      <span class="s1">&#39;to the hard minimum of 1e-10.&#39;</span><span class="p">)</span>
        <span class="n">type2_noise</span> <span class="o">=</span> <span class="mf">1e-10</span>

    <span class="k">if</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;lognorm_median_std&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = median, type2_noise = SD</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">type2_noise</span> <span class="o">/</span> <span class="n">type2_center</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)))</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">lognorm</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">type2_center</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;lognorm_mean&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = mean, type2_noise = SD in log space</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">lognorm</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">type2_noise</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">type2_center</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;lognorm_mode&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = mode, type2_noise = SD in log space</span>
        <span class="k">if</span> <span class="n">type2_noise</span> <span class="o">&gt;</span> <span class="mi">23</span><span class="p">:</span>
            <span class="c1"># warnings.warn(f&#39;Type 2 noise for a {type2_dist} distribution is too high. Capping at 23&#39;)</span>
            <span class="n">type2_noise</span> <span class="o">=</span> <span class="mi">23</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">lognorm</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">type2_noise</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">type2_center</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;lognorm_mode_std&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = mode, type2_noise = SD</span>
        <span class="n">shape</span><span class="p">,</span> <span class="n">type2_noise</span> <span class="o">=</span> <span class="n">_params_lognorm_mode_std</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">type2_center</span><span class="p">),</span> <span class="n">type2_noise</span><span class="p">)</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">lognorm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;lognorm_mean_std&#39;</span><span class="p">:</span>
        <span class="c1"># Corresponds to the CASSANDRE/LogN setup</span>
        <span class="c1"># type2_center = mean, type2_noise = SD</span>
        <span class="n">type2_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">type2_center</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">)</span>
        <span class="n">sigma2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">type2_noise</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">type2_center</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">type2_center</span><span class="p">)</span> <span class="o">-</span> <span class="n">sigma2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">lognorm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma2</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;beta_mean_std&#39;</span><span class="p">:</span>
        <span class="c1"># Canonical &quot;precision&quot; parameterization of the beta distribution, where precision = 1 / noise**2, i.e.</span>
        <span class="c1"># inverse variance.</span>
        <span class="c1"># type2_center = mean, type2_noise = SD</span>

        <span class="n">type2_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">type2_center</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-12</span><span class="p">)</span>          <span class="c1"># avoid a=0 or b=0</span>
        <span class="n">type2_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">type2_noise</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">)</span>

        <span class="n">phi</span> <span class="o">=</span> <span class="n">type2_center</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">type2_center</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">type2_noise</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">type2_center</span> <span class="o">*</span> <span class="n">phi</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">type2_center</span><span class="p">)</span> <span class="o">*</span> <span class="n">phi</span>

        <span class="n">dist</span> <span class="o">=</span> <span class="n">beta</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;beta_mode_std&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = mode, type2_noise = SD</span>

        <span class="n">type2_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">type2_center</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-8</span><span class="p">)</span>

        <span class="n">var_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">type2_noise</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">)</span>
        <span class="c1"># Initial closed-form approximation</span>
        <span class="n">kappa</span> <span class="o">=</span> <span class="n">type2_center</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">type2_center</span><span class="p">)</span> <span class="o">/</span> <span class="n">var_target</span>
        <span class="c1"># One-step variance correction</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">type2_center</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">type2_center</span><span class="p">)</span> <span class="o">*</span> <span class="n">kappa</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">kappa</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">den</span> <span class="o">=</span> <span class="p">(</span><span class="n">kappa</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">kappa</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">var_actual</span> <span class="o">=</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span>
        <span class="n">kappa</span> <span class="o">*=</span> <span class="n">var_actual</span> <span class="o">/</span> <span class="n">var_target</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">type2_center</span> <span class="o">*</span> <span class="n">kappa</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">type2_center</span><span class="p">)</span> <span class="o">*</span> <span class="n">kappa</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">beta</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;beta_mode&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = mode, type2_noise != SD</span>
        <span class="n">type2_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">type2_center</span><span class="p">))</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">type2_center</span><span class="p">)</span> <span class="o">*</span> <span class="n">type2_center</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">type2_noise</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">type2_center</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">type2_center</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">beta</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;betaprime_mean_std&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = mean, type2_noise = SD</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">type2_center</span> <span class="o">*</span> <span class="p">(</span><span class="n">type2_center</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">type2_noise</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">type2_center</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">betaprime</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;gamma_mode_std&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = mode, type2_noise = SD</span>
        <span class="n">u</span> <span class="o">=</span> <span class="p">(</span><span class="n">type2_center</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">type2_center</span> <span class="o">*</span> <span class="n">type2_center</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">type2_noise</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">type2_noise</span><span class="p">)</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">type2_noise</span> <span class="o">/</span> <span class="n">u</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;gamma_mean_std&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = mean, type2_noise = SD</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">type2_center</span> <span class="o">/</span> <span class="n">type2_noise</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="n">type2_noise</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">type2_center</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;gamma_mean&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = mean, type2_noise != SD</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">type2_center</span> <span class="o">/</span> <span class="n">type2_noise</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;gamma_mean_cv&#39;</span><span class="p">:</span>
        <span class="c1"># Corresponds to the CASSANDRE setup, i.e. standard multiplicative noise</span>
        <span class="c1"># type2_center = center, type2_noise = CV (relative noise)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">type2_noise</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">type2_center</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;gamma_mode&#39;</span><span class="p">:</span>
        <span class="c1"># type2_center = mode; type2_noise != SD</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">type2_center</span> <span class="o">/</span> <span class="n">type2_noise</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">type2_dist</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;truncated_&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_report&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_norm_mode_std&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mode, type2_noise = SD of the truncated distribution</span>
                <span class="n">sigma</span> <span class="o">=</span> <span class="n">_params_truncnorm_mode_std</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">)</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">truncnorm</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="n">type2_center</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">type2_center</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_norm_mode&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mode, type2_noise = SD of the *un*truncated distribution</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">truncnorm</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="n">type2_center</span> <span class="o">/</span> <span class="n">type2_noise</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">type2_center</span><span class="p">)</span> <span class="o">/</span> <span class="n">type2_noise</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_gumbel_mode_std&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mode, type2_noise = SD of the truncated distribution</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">TruncatedGumbelModeSD</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_newton</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_gumbel_mode&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mode, type2_noise = SD of the *un*truncated distribution</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">TruncatedGumbelMode</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">type2_noise</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_lognorm_mode_std&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mode, type2_noise = SD</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">TruncatedLognormalModeSD</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_newton</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_lognorm&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = median of the untruncated lognormal, type2_noise = SD in log space</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">TruncatedLognormal</span><span class="p">(</span><span class="n">median_untrunc</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_lognorm_mode&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mode, type2_noise = SD in log space</span>
                <span class="k">if</span> <span class="n">type2_noise</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
                    <span class="c1"># warnings.warn(f&#39;Type 2 noise for a {type2_dist} distribution is too high. Capping at 25&#39;)</span>
                    <span class="n">type2_noise</span> <span class="o">=</span> <span class="mi">25</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">TruncatedLognormalMode</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_lognorm_mean&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mean, type2_noise = SD in log space</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">TruncatedLognormalMean</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">type2_noise_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;noisy_readout&#39;</span><span class="p">,</span> <span class="s1">&#39;noisy_temperature&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_norm_mode_std&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mode, type2_noise = SD</span>
                <span class="n">sigma</span> <span class="o">=</span> <span class="n">_params_truncnorm_mode_std</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">)</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">truncnorm</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="n">type2_center</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_norm_mode&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mode, type2_noise != SD</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">truncnorm</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="n">type2_center</span> <span class="o">/</span> <span class="n">type2_noise</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_gumbel_mode_std&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mode, type2_noise = SD</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">TruncatedGumbelModeSD</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">type2_noise</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">n_newton</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type2_dist</span> <span class="o">==</span> <span class="s1">&#39;truncated_gumbel_mode&#39;</span><span class="p">:</span>
                <span class="c1"># type2_center = mode, type2_noise != SD</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">TruncatedGumbelMode</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">type2_center</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">type2_noise</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">type2_noise_type</span><span class="si">}</span><span class="s2">&#39; is an unknown type 2 noise type&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dist</span>  <span class="c1"># noqa</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.print_dataset_characteristics" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">print_dataset_characteristics</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">print_dataset_characteristics</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/util.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_dataset_characteristics</span><span class="p">(</span><span class="n">sim</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sim</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..Generative parameters:&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">params_type1</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}{</span><span class="n">p</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="w"> </span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..Generative model:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s1">Type 2 noise type: </span><span class="si">{</span><span class="n">sim</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s1">Type 2 noise distribution: </span><span class="si">{</span><span class="n">sim</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_dist</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..Generative parameters:&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}{</span><span class="n">p</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="w"> </span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sim</span><span class="o">.</span><span class="n">params_extra</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;type2_criteria_absolute&#39;</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">params_extra</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s2">Type 2 criteria (absolute): [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s1">.5g</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">params_extra</span><span class="p">[</span><span class="s1">&#39;type2_criteria_absolute&#39;</span><span class="p">]])</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;type2_criteria_bias&#39;</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">params_extra</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s2">Criterion bias: </span><span class="si">{</span><span class="n">sim</span><span class="o">.</span><span class="n">params_extra</span><span class="p">[</span><span class="s1">&#39;type2_criteria_bias&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..Descriptive statistics:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s1">No. subjects: </span><span class="si">{</span><span class="n">sim</span><span class="o">.</span><span class="n">nsubjects</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s1">No. samples: </span><span class="si">{</span><span class="n">sim</span><span class="o">.</span><span class="n">nsamples</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sim</span><span class="o">.</span><span class="n">type1_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s2">Performance: </span><span class="si">{</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sim</span><span class="o">.</span><span class="n">type1_stats</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% correct&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s2">Choice bias: </span><span class="si">{</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;+&#39;</span><span class="p">)[</span><span class="nb">int</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">type1_stats</span><span class="p">[</span><span class="s1">&#39;choice_bias&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)]</span><span class="si">}{</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">type1_stats</span><span class="p">[</span><span class="s1">&#39;choice_bias&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sim</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">skip_type2</span> <span class="ow">and</span> <span class="n">sim</span><span class="o">.</span><span class="n">type2_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s2">Confidence: </span><span class="si">{</span><span class="n">sim</span><span class="o">.</span><span class="n">type2_stats</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s2">M-Ratio: </span><span class="si">{</span><span class="n">sim</span><span class="o">.</span><span class="n">type2_stats</span><span class="p">[</span><span class="s1">&#39;mratio&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TAB</span><span class="si">}</span><span class="s2">AUROC2: </span><span class="si">{</span><span class="n">sim</span><span class="o">.</span><span class="n">type2_stats</span><span class="p">[</span><span class="s1">&#39;auroc2&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.simu_data" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">simu_data</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">simu_data</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">nsubjects</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stimuli_external</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stimuli_stepsize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_in_case_of_nondivisible_stepsize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compute_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/gendata.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simu_data</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">nsubjects</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stimuli_external</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stimuli_stepsize</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
              <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_in_case_of_nondivisible_stepsize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">compute_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># this variable can be modifed, thus better to make a copy</span>
    <span class="k">if</span> <span class="n">cfg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Set configuration attributes that match keyword arguments</span>
        <span class="n">cfg_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">Configuration</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">}</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">Configuration</span><span class="p">(</span><span class="o">**</span><span class="n">cfg_kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">setting</span> <span class="ow">in</span> <span class="n">cfg</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">setting</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;enable_&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">setting</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;enable_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_param_&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">setting</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c1"># if not cfg.setup_called:</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">generative_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_dist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_dist</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">noisy_report</span><span class="o">=</span><span class="s1">&#39;truncated_norm_mode&#39;</span><span class="p">,</span> <span class="n">noisy_readout</span><span class="o">=</span><span class="s1">&#39;truncated_norm_mode&#39;</span><span class="p">,</span> <span class="n">noisy_temperature</span><span class="o">=</span><span class="s1">&#39;lognorm_mode&#39;</span><span class="p">)[</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span><span class="p">]</span>

    <span class="c1"># Make sure no unwanted parameters have been passed</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;thresh&#39;</span><span class="p">,</span> <span class="s1">&#39;bias&#39;</span><span class="p">,</span> <span class="s1">&#39;noise_heteroscedastic&#39;</span><span class="p">,</span> <span class="s1">&#39;nonlinear_encoding_gain&#39;</span><span class="p">,</span> <span class="s1">&#39;nonlinear_encoding_transition&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;enable_type1_param_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
            <span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;type1_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;evidence_bias_mult&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;enable_type2_param_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
            <span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;type2_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">stimuli_external</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x_stim</span> <span class="o">=</span> <span class="n">generate_stimuli</span><span class="p">(</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="n">stimuli_stepsize</span><span class="p">,</span>
                                  <span class="n">warn_in_case_of_nondivisible_stepsize</span><span class="o">=</span><span class="n">warn_in_case_of_nondivisible_stepsize</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_stim</span> <span class="o">=</span> <span class="n">stimuli_external</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stimuli_external</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">stimuli_external</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">):</span>
            <span class="n">x_stim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x_stim</span><span class="p">,</span> <span class="p">(</span><span class="n">nsubjects</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">x_stim_category</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">x_stim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">y_decval_latent</span><span class="p">,</span> <span class="n">y_decval</span><span class="p">,</span> <span class="n">d_dec</span> <span class="o">=</span> <span class="n">simu_type1_responses</span><span class="p">(</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>

        <span class="n">z1_type1_evidence_latent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_decval_latent</span><span class="p">)</span>
        <span class="n">z1_type1_evidence_base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_decval</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_readout&#39;</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">get_type2_dist</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_dist</span><span class="p">,</span> <span class="n">type2_center</span><span class="o">=</span><span class="n">z1_type1_evidence_base</span><span class="p">,</span> <span class="n">type2_noise</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_noise&#39;</span><span class="p">],</span>
                                  <span class="n">type2_noise_type</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span><span class="p">)</span>

            <span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">((</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_temperature&#39;</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">get_type2_dist</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_dist</span><span class="p">,</span> <span class="n">type2_center</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type1_noise&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">z1_type1_evidence_base</span><span class="p">),</span>
                                  <span class="n">type2_noise</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_noise&#39;</span><span class="p">],</span> <span class="n">type2_noise_type</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span><span class="p">)</span>
            <span class="n">type1_noise_estimated</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
            <span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">z1_type1_evidence_base</span>
        <span class="k">elif</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_report&#39;</span><span class="p">:</span>
            <span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">z1_type1_evidence_base</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown type 2 noise type&#39;</span><span class="p">)</span>

        <span class="n">c_conf_latent</span> <span class="o">=</span> <span class="n">type1_evidence_to_confidence</span><span class="p">(</span>
            <span class="n">z1_type1_evidence</span><span class="o">=</span><span class="n">z1_type1_evidence_latent</span><span class="p">,</span> <span class="n">y_decval</span><span class="o">=</span><span class="n">y_decval</span><span class="p">,</span>
            <span class="n">x_stim</span><span class="o">=</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">type1_noise_signal_dependency</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">type1_noise_signal_dependency</span><span class="p">,</span>
            <span class="o">**</span><span class="p">({</span><span class="o">**</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">type1_noise</span><span class="o">=</span><span class="n">type1_noise_estimated</span><span class="p">)}</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_temperature&#39;</span> <span class="k">else</span> <span class="n">params</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">c_conf_base</span> <span class="o">=</span> <span class="n">type1_evidence_to_confidence</span><span class="p">(</span>
            <span class="n">z1_type1_evidence</span><span class="o">=</span><span class="n">z1_type1_evidence</span><span class="p">,</span> <span class="n">y_decval</span><span class="o">=</span><span class="n">y_decval</span><span class="p">,</span>
            <span class="n">x_stim</span><span class="o">=</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">type1_noise_signal_dependency</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">type1_noise_signal_dependency</span><span class="p">,</span>
            <span class="o">**</span><span class="p">({</span><span class="o">**</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">type1_noise</span><span class="o">=</span><span class="n">type1_noise_estimated</span><span class="p">)}</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_temperature&#39;</span> <span class="k">else</span> <span class="n">params</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;noisy_report&#39;</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">get_type2_dist</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_dist</span><span class="p">,</span> <span class="n">type2_center</span><span class="o">=</span><span class="n">c_conf_base</span><span class="p">,</span> <span class="n">type2_noise</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_noise&#39;</span><span class="p">],</span>
                                  <span class="n">type2_noise_type</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span><span class="p">)</span>
            <span class="n">c_conf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">((</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c_conf</span> <span class="o">=</span> <span class="n">c_conf_base</span>

        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">enable_type2_param_criteria</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;type2_criteria&#39;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                <span class="n">sum_criteria</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">sum_criteria</span> <span class="o">&gt;</span> <span class="mf">1.001</span><span class="p">:</span>
                    <span class="n">old_criteria</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]</span>
                    <span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_criteria_sum</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The first entry of the criterion list is a criterion, whereas the subsequent entries encode</span><span class="se">\n</span><span class="s1">&#39;</span>
                       <span class="s1">&#39;the gap to the respective previous criterion. Hence, the sum of all entries in the criterion</span><span class="se">\n</span><span class="s1">&#39;</span>
                       <span class="sa">f</span><span class="s2">&quot;list must be smaller than 1, but sum([</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">old_criteria</span><span class="p">])</span><span class="si">}</span><span class="s2">]) = </span><span class="si">{</span><span class="n">sum_criteria</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">).&quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;Changing criteria to [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]])</span><span class="si">}</span><span class="s2">].&quot;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
                <span class="n">first_criterion_and_gaps</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]</span>
                <span class="n">criteria</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">first_criterion_and_gaps</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">first_criterion_and_gaps</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">first_criterion_and_gaps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_discrete_confidence_levels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">n_discrete_confidence_levels</span>
                <span class="n">criteria</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">first_criterion_and_gaps</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">first_criterion_and_gaps</span><span class="p">)]</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Type 2 criteria enabled, but type2_criteria have not been specified. Using default values</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s2">&quot;of a Bayesian confidence observer for </span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_discrete_confidence_levels</span><span class="si">}</span><span class="s2"> discrete ratings: [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3g</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">first_criterion_and_gaps</span><span class="p">])</span><span class="si">}</span><span class="s2">].</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s1">&#39;Note that the first entry of the criterion list is a criterion, whereas the subsequent</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;entries encode the gap to the respective previous criterion.</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s2">&quot;The final criteria are: [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.3g</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">criteria</span><span class="p">])</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>

            <span class="n">c_conf</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">c_conf</span><span class="p">,</span> <span class="n">criteria</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">n_discrete_confidence_levels</span>
            <span class="n">c_conf_base</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">c_conf_base</span><span class="p">,</span> <span class="n">criteria</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">n_discrete_confidence_levels</span>

    <span class="k">if</span> <span class="n">squeeze</span><span class="p">:</span>
        <span class="n">x_stim_category</span> <span class="o">=</span> <span class="n">x_stim_category</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">x_stim</span> <span class="o">=</span> <span class="n">x_stim</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">d_dec</span> <span class="o">=</span> <span class="n">d_dec</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">y_decval_latent</span> <span class="o">=</span> <span class="n">y_decval_latent</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">y_decval</span> <span class="o">=</span> <span class="n">y_decval</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>
            <span class="n">z1_type1_evidence_base</span> <span class="o">=</span> <span class="n">z1_type1_evidence_base</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>  <span class="c1"># noqa</span>
            <span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">z1_type1_evidence</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>  <span class="c1"># noqa</span>
            <span class="n">c_conf_base</span> <span class="o">=</span> <span class="n">c_conf_base</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>  <span class="c1"># noqa</span>
            <span class="n">c_conf</span> <span class="o">=</span> <span class="n">c_conf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>  <span class="c1"># noqa</span>

    <span class="n">simargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">nsubjects</span><span class="o">=</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="n">nsamples</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">,</span>
        <span class="n">x_stim_category</span><span class="o">=</span><span class="n">x_stim_category</span><span class="p">,</span> <span class="n">x_stim</span><span class="o">=</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">d_dec</span><span class="o">=</span><span class="n">d_dec</span><span class="p">,</span>
        <span class="n">y_decval</span><span class="o">=</span><span class="n">y_decval</span><span class="p">,</span> <span class="n">y_decval_latent</span><span class="o">=</span><span class="n">y_decval_latent</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>
        <span class="n">simargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">z1_type1_evidence_latent</span><span class="o">=</span><span class="n">z1_type1_evidence_latent</span><span class="p">,</span> <span class="n">z1_type1_evidence_base</span><span class="o">=</span><span class="n">z1_type1_evidence_base</span><span class="p">,</span> <span class="n">z1_type1_evidence</span><span class="o">=</span><span class="n">z1_type1_evidence</span><span class="p">,</span>
            <span class="n">c_conf_latent</span><span class="o">=</span><span class="n">c_conf_latent</span><span class="p">,</span> <span class="n">c_conf_base</span><span class="o">=</span><span class="n">c_conf_base</span><span class="p">,</span> <span class="n">c_conf</span><span class="o">=</span><span class="n">c_conf</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">compute_stats</span><span class="p">:</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_stim_category</span> <span class="o">==</span> <span class="n">d_dec</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">type1_stats</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">accuracy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracy</span><span class="p">),</span>
            <span class="n">d1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">d_dec</span><span class="p">[</span><span class="n">x_stim_category</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())))</span> <span class="o">-</span> \
                 <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">d_dec</span><span class="p">[</span><span class="n">x_stim_category</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()))),</span>
            <span class="n">choice_bias</span><span class="o">=</span><span class="n">d_dec</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">simargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">type1_stats</span><span class="o">=</span><span class="n">type1_stats</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
            <span class="n">fit</span> <span class="o">=</span> <span class="n">type2_SDT_MLE</span><span class="p">(</span><span class="n">x_stim_category</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">d_dec</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">discretize_confidence_with_bounds</span><span class="p">(</span><span class="n">c_conf</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bounds</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">))</span>
            <span class="n">type2_stats</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">confidence</span><span class="o">=</span><span class="n">c_conf</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                <span class="n">auroc2</span><span class="o">=</span><span class="n">type2roc</span><span class="p">(</span><span class="n">accuracy</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">c_conf</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span>
                <span class="n">mratio</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">M_ratio</span>
            <span class="p">)</span>
            <span class="n">simargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">type2_stats</span><span class="o">=</span><span class="n">type2_stats</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;type2_criteria&#39;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                <span class="n">params_extra</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">type2_criteria_absolute</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">][:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]))],</span>
                    <span class="n">type2_criteria_bias</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="p">)</span>
                <span class="n">simargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params_extra</span><span class="o">=</span><span class="n">params_extra</span><span class="p">)</span>


    <span class="n">simulation</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="o">**</span><span class="n">simargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbosity</span><span class="p">:</span>
        <span class="n">print_dataset_characteristics</span><span class="p">(</span><span class="n">simulation</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">simulation</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.simu_type1_responses" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">simu_type1_responses</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">simu_type1_responses</span><span class="p">(</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/gendata.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simu_type1_responses</span><span class="p">(</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">type1_noise_signal_dependency</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">enable_type1_param_noise</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">type1_noise</span> <span class="o">=</span> <span class="n">compute_signal_dependent_type1_noise</span><span class="p">(</span>
            <span class="n">x_stim</span><span class="o">=</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">type1_noise_signal_dependency</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">type1_noise_signal_dependency</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">type1_noise</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;type1_noise&#39;</span><span class="p">]</span>

    <span class="n">type1_param_thresh</span> <span class="o">=</span> <span class="n">_check_param</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type1_thresh&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">enable_type1_param_thresh</span> <span class="k">else</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">type1_param_bias</span> <span class="o">=</span> <span class="n">_check_param</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type1_bias&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">enable_type1_param_bias</span> <span class="k">else</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">enable_type1_param_nonlinear_encoding_gain</span><span class="p">:</span>
        <span class="n">x_stim_transform</span> <span class="o">=</span> <span class="n">compute_nonlinear_encoding</span><span class="p">(</span>
            <span class="n">x_stim</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;type1_nonlinear_encoding_gain&#39;</span><span class="p">],</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;type1_nonlinear_encoding_transition&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">enable_type1_param_nonlinear_encoding_transition</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_stim_transform</span> <span class="o">=</span> <span class="n">x_stim</span>

    <span class="n">y_decval_latent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">x_stim_transform</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">y_decval_latent</span><span class="p">[</span><span class="n">x_stim_transform</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_stim_transform</span><span class="p">[</span><span class="n">x_stim_transform</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">type1_param_thresh</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> \
                                   <span class="n">x_stim_transform</span><span class="p">[</span><span class="n">x_stim_transform</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">type1_param_bias</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y_decval_latent</span><span class="p">[</span><span class="n">x_stim_transform</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_stim_transform</span><span class="p">[</span><span class="n">x_stim_transform</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">type1_param_thresh</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> \
                                    <span class="n">x_stim_transform</span><span class="p">[</span><span class="n">x_stim_transform</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">type1_param_bias</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">y_decval</span> <span class="o">=</span> <span class="n">y_decval_latent</span> <span class="o">+</span> <span class="n">logistic_dist</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">type1_noise</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x_stim_transform</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">d_dec</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_decval</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y_decval_latent</span><span class="p">,</span> <span class="n">y_decval</span><span class="p">,</span> <span class="n">d_dec</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.type1_evidence_to_confidence" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">type1_evidence_to_confidence</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">type1_evidence_to_confidence</span><span class="p">(</span><span class="n">z1_type1_evidence</span><span class="p">,</span> <span class="n">type2_evidence_bias_mult</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">type1_noise</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_thresh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_noise_heteroscedastic</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_noise_signal_dependency</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">y_decval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_stim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Transformation from type 1 evidence (z1) to confidence (c).</p>
<h4 id="remeta.gendata.type1_evidence_to_confidence--parameters">Parameters</h4>
<p>z1_type1_evidence : array-like
    Evidence at the type 1 level (= absolute decision value).
type2_evidence_bias_mult : float or array-like
    Multiplicative metacognitive bias parameter loading on evidence.
type1_noise : float or array-like
    Type 1 noise parameter. Can be array-like in case of signal-dependent type 1 noise.
type1_noise_heteroscedastic : float or array-like
    Signal-dependent type 1 noise parameter.
type1_noise_signal_dependency : str
    Signal-dependent type 1 noise type. One of 'linear', 'power', 'exponential', 'logarithm'.
y_decval : array-like
    Decision values.
x_stim : array-like
    Array of signed stimulus intensity values, where the sign codes the stimulus category and the absolut value
    codes the intensity.
kwargs : dict
    Convenience parameter to avoid an error if irrelevant parameters are passed.</p>
<h4 id="remeta.gendata.type1_evidence_to_confidence--returns">Returns</h4>
<p>c_conf : array-like
    Model-predicted confidence.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">type1_evidence_to_confidence</span><span class="p">(</span><span class="n">z1_type1_evidence</span><span class="p">,</span>
                                 <span class="n">type2_evidence_bias_mult</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">type1_noise</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_thresh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">type1_noise_heteroscedastic</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type1_noise_signal_dependency</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                 <span class="n">y_decval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_stim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># noqa</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transformation from type 1 evidence (z1) to confidence (c).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    z1_type1_evidence : array-like</span>
<span class="sd">        Evidence at the type 1 level (= absolute decision value).</span>
<span class="sd">    type2_evidence_bias_mult : float or array-like</span>
<span class="sd">        Multiplicative metacognitive bias parameter loading on evidence.</span>
<span class="sd">    type1_noise : float or array-like</span>
<span class="sd">        Type 1 noise parameter. Can be array-like in case of signal-dependent type 1 noise.</span>
<span class="sd">    type1_noise_heteroscedastic : float or array-like</span>
<span class="sd">        Signal-dependent type 1 noise parameter.</span>
<span class="sd">    type1_noise_signal_dependency : str</span>
<span class="sd">        Signal-dependent type 1 noise type. One of &#39;linear&#39;, &#39;power&#39;, &#39;exponential&#39;, &#39;logarithm&#39;.</span>
<span class="sd">    y_decval : array-like</span>
<span class="sd">        Decision values.</span>
<span class="sd">    x_stim : array-like</span>
<span class="sd">        Array of signed stimulus intensity values, where the sign codes the stimulus category and the absolut value</span>
<span class="sd">        codes the intensity.</span>
<span class="sd">    kwargs : dict</span>
<span class="sd">        Convenience parameter to avoid an error if irrelevant parameters are passed.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    c_conf : array-like</span>
<span class="sd">        Model-predicted confidence.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">z1_type1_evidence</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">((</span><span class="n">type1_noise_signal_dependency</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">type1_noise</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">type1_noise</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">x_stim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Type 1 noise is signal-dependent, but stimuli (x_stim) have not been &#39;</span>
                             <span class="s1">&#39;passed.&#39;</span><span class="p">)</span>
        <span class="n">type1_noise</span> <span class="o">=</span> <span class="n">compute_signal_dependent_type1_noise</span><span class="p">(</span>
            <span class="n">x_stim</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">x_stim</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">z1_type1_evidence</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">else</span> <span class="n">x_stim</span><span class="p">,</span>
            <span class="n">type1_noise</span><span class="o">=</span><span class="n">type1_noise</span><span class="p">,</span> <span class="n">type1_thresh</span><span class="o">=</span><span class="n">type1_thresh</span><span class="p">,</span> <span class="n">type1_noise_heteroscedastic</span><span class="o">=</span><span class="n">type1_noise_heteroscedastic</span><span class="p">,</span>
            <span class="n">type1_noise_signal_dependency</span><span class="o">=</span><span class="n">type1_noise_signal_dependency</span><span class="p">)</span>

    <span class="n">z2_type2_evidence</span> <span class="o">=</span> <span class="n">type2_evidence_bias_mult</span> <span class="o">*</span> <span class="n">z1_type1_evidence</span>
    <span class="n">c_conf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">z2_type2_evidence</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">type1_noise</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">c_conf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.type2_SDT_MLE" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">type2_SDT_MLE</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">type2_SDT_MLE</span><span class="p">(</span><span class="n">stimID</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">nRatings</span><span class="p">,</span> <span class="n">cellpadding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">equalVariance</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/type2_SDT.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">type2_SDT_MLE</span><span class="p">(</span><span class="n">stimID</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">nRatings</span><span class="p">,</span> <span class="n">cellpadding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">equalVariance</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># out = type2_SDT(input)</span>
    <span class="c1">#</span>
    <span class="c1"># Given data from an experiment where an observer discriminates between two</span>
    <span class="c1"># stimulus alternatives on every trial and provides confidence ratings,</span>
    <span class="c1"># provides a type 2 SDT analysis of the data.</span>
    <span class="c1">#</span>
    <span class="c1"># The function estimates the parameters of the unequal variance SDT model,</span>
    <span class="c1"># and uses those estimates to find a maximum likelihood estimate of</span>
    <span class="c1"># meta-da.</span>
    <span class="c1">#</span>
    <span class="c1"># INPUTS</span>
    <span class="c1">#</span>
    <span class="c1"># format of the input may be either:</span>
    <span class="c1">#</span>
    <span class="c1"># 1) stimID, response, rating, nRatings, (cellpadding), (equalVariance)</span>
    <span class="c1">#    where each of the first 3 inputs is a 1xN vector describing the outcome</span>
    <span class="c1">#    of N trials. Contents of input should be as follows.</span>
    <span class="c1">#</span>
    <span class="c1">#    stimID   : 0=S1 stimulus presented, 1=S2 stimulus presented</span>
    <span class="c1">#    response : 0=subject responded S1, 1=subject responded S2</span>
    <span class="c1">#    rating   : values ranges from 1 to m where 1 is the lowest rating</span>
    <span class="c1">#               and m is the highest.</span>
    <span class="c1">#</span>
    <span class="c1">#               All trials where any of these prescribed ranges of values</span>
    <span class="c1">#               are violated are omitted from analysis.</span>
    <span class="c1">#</span>
    <span class="c1">#    nRatings : the number of ratings available to the subject (e.g. for a</span>
    <span class="c1">#               confidence scale of 1-4, nRatings=4).</span>
    <span class="c1">#    cellpadding : if any data cells (e.g. high confidence &quot;S2&quot; responses)</span>
    <span class="c1">#               are empty, then the value of cellpadding will be added</span>
    <span class="c1">#               to every data cell. If not specified, default = 1/(2*nRatings)</span>
    <span class="c1">#    equalVariance : if 1, force analysis to use the equal variance SDT</span>
    <span class="c1">#               model. If 0, use an estimate of s = sd(S1) / sd(S2) where</span>
    <span class="c1">#               s is the slope of the zROC data (estimated using MLE).</span>
    <span class="c1">#               If not specified, default = 0.</span>
    <span class="c1">#</span>
    <span class="c1"># 2) nR_S1, nR_S2, (cellpadding), (equalVariance)</span>
    <span class="c1">#    where these are vectors containing the total number of responses in</span>
    <span class="c1">#    each response modality, conditional on presentation of S1 and S2.</span>
    <span class="c1">#    size of each array is 2*nRatings, where each element corresponds to a</span>
    <span class="c1">#    count of responses in each response modality. Response categories are</span>
    <span class="c1">#    ordered as follows:</span>
    <span class="c1">#    highest conf &quot;S1&quot; ... lowest conf &quot;S1&quot;, lowest conf &quot;S2&quot;, ... highest conf &quot;S2&quot;</span>
    <span class="c1">#</span>
    <span class="c1">#    e.g. if nR_S1 = [100 50 20 10 5 1], then when stimulus S1 was</span>
    <span class="c1">#    presented, the subject had the following response counts:</span>
    <span class="c1">#    responded S1, rating=3 : 100 times</span>
    <span class="c1">#    responded S1, rating=2 : 50 times</span>
    <span class="c1">#    responded S1, rating=1 : 20 times</span>
    <span class="c1">#    responded S2, rating=1 : 10 times</span>
    <span class="c1">#    responded S2, rating=2 : 5 times</span>
    <span class="c1">#    responded S2, rating=3 : 1 time</span>
    <span class="c1">#</span>
    <span class="c1">#    cellpadding and equalVariance are defined as above.</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1"># OUTPUTS</span>
    <span class="c1">#</span>
    <span class="c1"># out.d_a       : d_a for input data. If s=1, d_a = d&#39;</span>
    <span class="c1"># out.meta_d_a  : meta_d_a for input data</span>
    <span class="c1"># out.M_ratio   : meta_d_a / d_a; measure of metacognitive efficiency</span>
    <span class="c1"># out.M_diff    : meta_d_a - d_a; measure of metacognitive efficiency</span>
    <span class="c1"># out.c_a       : criterion c_a for input data. If s=1, c_a = c.</span>
    <span class="c1"># out.cprime    : relative criterion used for type 2 estimates. c&#39; = c_a / d_a</span>
    <span class="c1"># out.s         : ratio of evidence distribution standard deviations assumed for the analysis.</span>
    <span class="c1"># out.type2_fit : output of fit_meta_d_MLE for the type 2 SDT fit.</span>

    <span class="c1"># 9/24/10 - bm - fixed program-crashing bug for (nR_S1, nR_S2) input</span>
    <span class="c1"># 9/7/10 - bm - wrote it</span>

    <span class="c1">## parse inputs</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stimID</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Empty data&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cellpadding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cellpadding</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">nRatings</span><span class="p">)</span>

    <span class="c1"># filters bad trials</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">((</span><span class="n">stimID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">stimID</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">response</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">response</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">rating</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rating</span> <span class="o">&lt;=</span> <span class="n">nRatings</span><span class="p">))</span>
    <span class="n">stimID</span> <span class="o">=</span> <span class="n">stimID</span><span class="p">[</span><span class="n">f</span><span class="p">]</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="n">f</span><span class="p">]</span>
    <span class="n">rating</span> <span class="o">=</span> <span class="n">rating</span><span class="p">[</span><span class="n">f</span><span class="p">]</span>

    <span class="c1"># convert to trial count format...</span>
    <span class="n">nR_S1</span><span class="p">,</span> <span class="n">nR_S2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nRatings</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nRatings</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="c1"># get tallies of &quot;S1&quot; rating responses for S1 and S2 stim</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nRatings</span><span class="p">):</span>
        <span class="n">nR_S1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">stimID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">response</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rating</span> <span class="o">==</span> <span class="n">nRatings</span> <span class="o">-</span> <span class="n">i</span><span class="p">))</span>
        <span class="n">nR_S2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">stimID</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">response</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rating</span> <span class="o">==</span> <span class="n">nRatings</span> <span class="o">-</span> <span class="n">i</span><span class="p">))</span>

    <span class="c1"># get tallies of &quot;S2&quot; rating responses for S1 and S2 stim</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nRatings</span><span class="p">):</span>
        <span class="n">nR_S1</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">nRatings</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">stimID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">response</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rating</span> <span class="o">==</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">nR_S2</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">nRatings</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">stimID</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">response</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rating</span> <span class="o">==</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">nR_S1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">nR_S2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">nR_S1</span> <span class="o">=</span> <span class="n">nR_S1</span> <span class="o">+</span> <span class="n">cellpadding</span>
        <span class="n">nR_S2</span> <span class="o">=</span> <span class="n">nR_S2</span> <span class="o">+</span> <span class="n">cellpadding</span>

    <span class="c1">## standard SDT analysis</span>

    <span class="k">if</span> <span class="n">equalVariance</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1">## type 2 SDT analysis</span>

    <span class="n">fit</span> <span class="o">=</span> <span class="n">fit_meta_d_MLE</span><span class="p">(</span><span class="n">nR_S1</span><span class="p">,</span> <span class="n">nR_S2</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fit</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="remeta.gendata.type2roc" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">type2roc</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">type2roc</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="n">conf</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/type2_SDT.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">type2roc</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="n">conf</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="c1"># Calculate area under type 2 ROC</span>
    <span class="c1">#</span>
    <span class="c1"># correct - vector of 1 x ntrials, 0 for error, 1 for correct</span>
    <span class="c1"># conf - vector of continuous confidence ratings between 0 and 1</span>
    <span class="c1"># nbins - how many bins to use for discretization</span>

    <span class="n">bs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">nbins</span>
    <span class="n">H2</span><span class="p">,</span> <span class="n">FA2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nbins</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nbins</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbins</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">H2</span><span class="p">[</span><span class="n">nbins</span> <span class="o">-</span> <span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">conf</span> <span class="o">&gt;</span> <span class="n">c</span><span class="o">*</span><span class="n">bs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">conf</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">bs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">correct</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5</span>
            <span class="n">FA2</span><span class="p">[</span><span class="n">nbins</span> <span class="o">-</span> <span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">conf</span> <span class="o">&gt;</span> <span class="n">c</span><span class="o">*</span><span class="n">bs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">conf</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">bs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H2</span><span class="p">[</span><span class="n">nbins</span> <span class="o">-</span> <span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">conf</span> <span class="o">&gt;=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">bs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">conf</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">bs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">correct</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5</span>
            <span class="n">FA2</span><span class="p">[</span><span class="n">nbins</span> <span class="o">-</span> <span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">conf</span> <span class="o">&gt;=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">bs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">conf</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">bs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5</span>

    <span class="n">H2</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">H2</span><span class="p">)</span>
    <span class="n">FA2</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">FA2</span><span class="p">)</span>
    <span class="n">cum_H2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">H2</span><span class="p">)))</span>
    <span class="n">cum_FA2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">FA2</span><span class="p">)))</span>

    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nbins</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbins</span><span class="p">):</span>
        <span class="n">k</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cum_H2</span><span class="p">[</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">cum_FA2</span><span class="p">[</span><span class="n">c</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">cum_H2</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">-</span> <span class="n">cum_FA2</span><span class="p">[</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">auroc2</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">auroc2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.expand"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../javascripts/external-tabs.js"></script>
      
    
  </body>
</html>