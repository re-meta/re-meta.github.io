
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://re-meta.github.io/api/simulation/">
      
      
        <link rel="prev" href="../configuration/">
      
      
        <link rel="next" href="../plot/">
      
      
        
      
      
      <link rel="icon" href="../img/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Simulation - ReMeta API</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#remetasimulation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ReMeta API" class="md-header__button md-logo" aria-label="ReMeta API" data-md-component="logo">
      
  <img src="../img/logo_api.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ReMeta API
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Simulation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/coconeuro/remeta" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg width="1024" height="1024" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" transform="scale(64)" fill="#1B1F23"/>
</svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ReMeta API" class="md-nav__button md-logo" aria-label="ReMeta API" data-md-component="logo">
      
  <img src="../img/logo_api.png" alt="logo">

    </a>
    ReMeta API
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/coconeuro/remeta" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg width="1024" height="1024" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" transform="scale(64)" fill="#1B1F23"/>
</svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://re-meta.github.io" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    → Guide ⮺
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ReMeta
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Simulation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Simulation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simulate" class="md-nav__link">
    <span class="md-ellipsis">
      
        simulate
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simulation
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plotting
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simulate" class="md-nav__link">
    <span class="md-ellipsis">
      
        simulate
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simulation
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="remetasimulation">remeta.simulation</h1>
<h2 id="simulate">simulate</h2>


<div class="doc doc-object doc-function">




    <div class="doc doc-contents first">

        <p>Simulate data for ReMeta</p>


<details class="usage" open>
  <summary>Usage</summary>
  <p><code>sim = simulate(params=dict(type1_noise=0.5, type2_noise=0.3))</code></p>
<p><code>sim = simulate(params=dict(type1_noise=0.5, type2_noise=0.3), nsamples=500)</code></p>
<p><code>sim = simulate(params=dict(type1_noise=0.5, type2_noise=0.3), cfg=cfg)</code></p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameter values (dictionary with {param_name: param_value} entries)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nsubjects</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of subjects</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nsamples</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples per subject</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg</code>
            </td>
            <td>
                  <code><span title="remeta.configuration.Configuration">Configuration</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>remeta.configuration.Configuration</code> instance (for model specification)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stim_min</code>
            </td>
            <td>
                  <code><span title="float">float</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>minimum stimulus intensity</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stim_max</code>
            </td>
            <td>
                  <code><span title="float">float</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>maximum stimulus intensity</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stim_levels</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of different stimulus intensity levels</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>custom_stimuli</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(optional) pass a custom array or list of signed stimulus intensities</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>squeeze</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>True</code> and only 1 subject is simulated, remove the subject dimension</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>compute_stats</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>True</code>, compute some descriptive statistics on the simulated dataset</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>silence_warnings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>True</code>, silences a few (custom) warnings</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbosity</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>verbosity level (possible values: 0, 1, 2)</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>extra arguments will be passed to the configuration</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns: a <code>remeta.simulation.Simulation</code> instance</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>remeta/simulation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">nsubjects</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">nsamples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">cfg</span><span class="p">:</span> <span class="n">Configuration</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stim_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stim_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">stim_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">custom_stimuli</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">squeeze</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">compute_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">silence_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Simulation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate data for ReMeta</span>

<span class="sd">    Usage:</span>
<span class="sd">        `sim = simulate(params=dict(type1_noise=0.5, type2_noise=0.3))`</span>

<span class="sd">        `sim = simulate(params=dict(type1_noise=0.5, type2_noise=0.3), nsamples=500)`</span>

<span class="sd">        `sim = simulate(params=dict(type1_noise=0.5, type2_noise=0.3), cfg=cfg)`</span>


<span class="sd">    Args:</span>
<span class="sd">        params: Parameter values (dictionary with {param_name: param_value} entries)</span>
<span class="sd">        nsubjects: Number of subjects</span>
<span class="sd">        nsamples: Number of samples per subject</span>
<span class="sd">        cfg: `remeta.configuration.Configuration` instance (for model specification)</span>
<span class="sd">        stim_min: minimum stimulus intensity</span>
<span class="sd">        stim_max: maximum stimulus intensity</span>
<span class="sd">        stim_levels: number of different stimulus intensity levels</span>
<span class="sd">        custom_stimuli: (optional) pass a custom array or list of signed stimulus intensities</span>
<span class="sd">        squeeze: if `True` and only 1 subject is simulated, remove the subject dimension</span>
<span class="sd">        compute_stats: if `True`, compute some descriptive statistics on the simulated dataset</span>
<span class="sd">        silence_warnings: if `True`, silences a few (custom) warnings</span>
<span class="sd">        verbosity: verbosity level (possible values: 0, 1, 2)</span>
<span class="sd">        **kwargs: extra arguments will be passed to the configuration</span>

<span class="sd">    Returns: a `remeta.simulation.Simulation` instance</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># this variable can be modifed, better make a copy</span>
    <span class="k">if</span> <span class="n">cfg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Set configuration attributes that match keyword arguments</span>
        <span class="n">cfg_dict</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="vm">__dict__</span>
        <span class="n">cfg_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cfg_dict</span><span class="p">}</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">Configuration</span><span class="p">(</span><span class="o">**</span><span class="n">cfg_kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;param_</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">cfg_dict</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;param_</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span> <span class="s1">&#39;enable&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="n">listlike</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unknown parameter </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cfg_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;param_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="s1">&#39;enable&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># for setting in cfg.__dict__:</span>
        <span class="c1">#     if setting.startswith(&#39;param_&#39;):</span>
        <span class="c1">#         if setting.split(&#39;param_&#39;)[1] not in params:</span>
        <span class="c1">#             setattr(getattr(cfg, setting), &#39;enable&#39;, 0)</span>
    <span class="c1"># if not cfg.setup_called:</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">generative_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">silence_warnings</span><span class="o">=</span><span class="n">silence_warnings</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">param_type2_noise</span><span class="o">.</span><span class="n">model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">param_type2_noise</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">report</span><span class="o">=</span><span class="s1">&#39;truncated_norm_mode&#39;</span><span class="p">,</span> <span class="n">readout</span><span class="o">=</span><span class="s1">&#39;truncated_norm_mode&#39;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="s1">&#39;lognorm_mode&#39;</span><span class="p">)[</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span><span class="p">]</span>

    <span class="c1"># Make sure no unwanted parameters have been passed</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;thresh&#39;</span><span class="p">,</span> <span class="s1">&#39;bias&#39;</span><span class="p">,</span> <span class="s1">&#39;noise_heteroscedastic&#39;</span><span class="p">,</span> <span class="s1">&#39;nonlinear_gain&#39;</span><span class="p">,</span> <span class="s1">&#39;nonlinear_scale&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;param_type1_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">enable</span><span class="p">:</span>
            <span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;type1_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;evidence_bias&#39;</span><span class="p">,</span> <span class="s1">&#39;confidence_bias&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;param_type2_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">enable</span><span class="p">:</span>
            <span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;type2_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">custom_stimuli</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x_stim</span> <span class="o">=</span> <span class="n">generate_stimuli</span><span class="p">(</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">,</span> <span class="n">stim_min</span><span class="o">=</span><span class="n">stim_min</span><span class="p">,</span> <span class="n">stim_max</span><span class="o">=</span><span class="n">stim_max</span><span class="p">,</span> <span class="n">stim_levels</span><span class="o">=</span><span class="n">stim_levels</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">custom_stimuli</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">custom_stimuli</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">custom_stimuli</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">custom_stimuli</span> <span class="o">=</span> <span class="n">custom_stimuli</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">nsamples</span> <span class="o">=</span> <span class="n">custom_stimuli</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x_stim</span> <span class="o">=</span> <span class="n">custom_stimuli</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">custom_stimuli</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x_stim</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nsubjects</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">x_stim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x_stim</span><span class="p">,</span> <span class="p">(</span><span class="n">nsubjects</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">x_stim_category</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">x_stim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">y_decval_latent</span><span class="p">,</span> <span class="n">y_decval</span><span class="p">,</span> <span class="n">d_dec</span> <span class="o">=</span> <span class="n">stimulus_to_decision_value</span><span class="p">(</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>

        <span class="n">z1_type1_evidence_latent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_decval_latent</span><span class="p">)</span>
        <span class="n">z1_type1_evidence_base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_decval</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;readout&#39;</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">get_type2_dist</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">param_type2_noise</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">type2_center</span><span class="o">=</span><span class="n">z1_type1_evidence_base</span><span class="p">,</span> <span class="n">type2_noise</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_noise&#39;</span><span class="p">],</span>
                                  <span class="n">type2_noise_type</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span><span class="p">)</span>

            <span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">((</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">get_type2_dist</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">param_type2_noise</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">type2_center</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type1_noise&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">z1_type1_evidence_base</span><span class="p">),</span>
                                  <span class="n">type2_noise</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_noise&#39;</span><span class="p">],</span> <span class="n">type2_noise_type</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span><span class="p">)</span>
            <span class="n">type1_noise_estimated</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
            <span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">z1_type1_evidence_base</span>
        <span class="k">elif</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;report&#39;</span><span class="p">:</span>
            <span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">z1_type1_evidence_base</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown type 2 noise type&#39;</span><span class="p">)</span>

        <span class="n">c_conf_latent</span> <span class="o">=</span> <span class="n">type1_evidence_to_confidence</span><span class="p">(</span>
            <span class="n">z1_type1_evidence</span><span class="o">=</span><span class="n">z1_type1_evidence_latent</span><span class="p">,</span> <span class="n">y_decval</span><span class="o">=</span><span class="n">y_decval</span><span class="p">,</span>
            <span class="n">x_stim</span><span class="o">=</span><span class="n">x_stim</span><span class="p">,</span>
            <span class="n">type1_noise_signal_dependency</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">param_type1_noise_heteroscedastic</span><span class="o">.</span><span class="n">model</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">param_type1_noise_heteroscedastic</span><span class="o">.</span><span class="n">enable</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="p">({</span><span class="o">**</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">type1_noise</span><span class="o">=</span><span class="n">type1_noise_estimated</span><span class="p">)}</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span> <span class="k">else</span> <span class="n">params</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">c_conf_base</span> <span class="o">=</span> <span class="n">type1_evidence_to_confidence</span><span class="p">(</span>
            <span class="n">z1_type1_evidence</span><span class="o">=</span><span class="n">z1_type1_evidence</span><span class="p">,</span> <span class="n">y_decval</span><span class="o">=</span><span class="n">y_decval</span><span class="p">,</span>
            <span class="n">x_stim</span><span class="o">=</span><span class="n">x_stim</span><span class="p">,</span>
            <span class="n">type1_noise_signal_dependency</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">param_type1_noise_heteroscedastic</span><span class="o">.</span><span class="n">model</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">param_type1_noise_heteroscedastic</span><span class="o">.</span><span class="n">enable</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="p">({</span><span class="o">**</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">type1_noise</span><span class="o">=</span><span class="n">type1_noise_estimated</span><span class="p">)}</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span> <span class="k">else</span> <span class="n">params</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span> <span class="o">==</span> <span class="s1">&#39;report&#39;</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">get_type2_dist</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">param_type2_noise</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">type2_center</span><span class="o">=</span><span class="n">c_conf_base</span><span class="p">,</span> <span class="n">type2_noise</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_noise&#39;</span><span class="p">],</span>
                                  <span class="n">type2_noise_type</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">type2_noise_type</span><span class="p">)</span>
            <span class="n">c_conf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">((</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c_conf</span> <span class="o">=</span> <span class="n">c_conf_base</span>

        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">param_type2_criteria</span><span class="o">.</span><span class="n">enable</span> <span class="ow">or</span> <span class="n">cfg</span><span class="o">.</span><span class="n">param_type2_criteria</span><span class="o">.</span><span class="n">preset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">param_type2_criteria</span><span class="o">.</span><span class="n">enable</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Type 2 criteria must be provided in an ascending manner and be between 0 and 1.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                     <span class="sa">f</span><span class="s2">&quot;Provided criteria: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]),</span><span class="w"> </span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># convert to criterion gaps</span>
                <span class="c1"># old_criteria = np.array(params[&#39;type2_criteria&#39;]).copy()</span>
                <span class="c1"># params[&#39;type2_criteria&#39;] = np.diff(np.hstack((0, params[&#39;type2_criteria&#39;])))</span>
                <span class="c1"># criteria_gaps = params[&#39;type2_criteria&#39;]</span>
                <span class="c1"># criteria = [v if i == 0 else np.sum(criteria_gaps[:i+1]) for i, v in enumerate(criteria_gaps)]</span>
                <span class="n">criteria</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">cfg</span><span class="o">.</span><span class="n">param_type2_criteria</span><span class="o">.</span><span class="n">preset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">criteria</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">_n_conf_levels</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">1e-10</span><span class="p">,</span>  <span class="mi">1</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">_n_conf_levels</span><span class="p">)</span>

            <span class="n">c_conf</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">c_conf</span><span class="p">,</span> <span class="n">criteria</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">_n_conf_levels</span>
            <span class="n">c_conf_base</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">c_conf_base</span><span class="p">,</span> <span class="n">criteria</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">_n_conf_levels</span>

    <span class="k">if</span> <span class="n">squeeze</span><span class="p">:</span>
        <span class="n">x_stim_category</span> <span class="o">=</span> <span class="n">x_stim_category</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">x_stim</span> <span class="o">=</span> <span class="n">x_stim</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">d_dec</span> <span class="o">=</span> <span class="n">d_dec</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">y_decval_latent</span> <span class="o">=</span> <span class="n">y_decval_latent</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">y_decval</span> <span class="o">=</span> <span class="n">y_decval</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>
            <span class="n">z1_type1_evidence_base</span> <span class="o">=</span> <span class="n">z1_type1_evidence_base</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>  <span class="c1"># noqa</span>
            <span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">z1_type1_evidence</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>  <span class="c1"># noqa</span>
            <span class="n">c_conf_base</span> <span class="o">=</span> <span class="n">c_conf_base</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>  <span class="c1"># noqa</span>
            <span class="n">c_conf</span> <span class="o">=</span> <span class="n">c_conf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>  <span class="c1"># noqa</span>

    <span class="n">simargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">nsubjects</span><span class="o">=</span><span class="n">nsubjects</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="n">nsamples</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">,</span>
        <span class="n">x_stim_category</span><span class="o">=</span><span class="n">x_stim_category</span><span class="p">,</span> <span class="n">x_stim</span><span class="o">=</span><span class="n">x_stim</span><span class="p">,</span> <span class="n">d_dec</span><span class="o">=</span><span class="n">d_dec</span><span class="p">,</span>
        <span class="n">y_decval</span><span class="o">=</span><span class="n">y_decval</span><span class="p">,</span> <span class="n">y_decval_latent</span><span class="o">=</span><span class="n">y_decval_latent</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>
        <span class="n">simargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">z1_type1_evidence_latent</span><span class="o">=</span><span class="n">z1_type1_evidence_latent</span><span class="p">,</span> <span class="n">z1_type1_evidence_base</span><span class="o">=</span><span class="n">z1_type1_evidence_base</span><span class="p">,</span> <span class="n">z1_type1_evidence</span><span class="o">=</span><span class="n">z1_type1_evidence</span><span class="p">,</span>
            <span class="n">c_conf_latent</span><span class="o">=</span><span class="n">c_conf_latent</span><span class="p">,</span> <span class="n">c_conf_base</span><span class="o">=</span><span class="n">c_conf_base</span><span class="p">,</span> <span class="n">c_conf</span><span class="o">=</span><span class="n">c_conf</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">compute_stats</span><span class="p">:</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_stim_category</span> <span class="o">==</span> <span class="n">d_dec</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">type1_stats</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">accuracy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracy</span><span class="p">),</span>
            <span class="n">dprime</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">d_dec</span><span class="p">[</span><span class="n">x_stim_category</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())))</span> <span class="o">-</span> \
                 <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">d_dec</span><span class="p">[</span><span class="n">x_stim_category</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()))),</span>
            <span class="n">choice_bias</span><span class="o">=</span><span class="n">d_dec</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">x_stim_category</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">simargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">type1_stats</span><span class="o">=</span><span class="n">type1_stats</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="o">.</span><span class="n">skip_type2</span><span class="p">:</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
            <span class="n">fit</span> <span class="o">=</span> <span class="n">type2_SDT_MLE</span><span class="p">(</span><span class="n">x_stim_category</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">d_dec</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">discretize_confidence_with_bounds</span><span class="p">(</span><span class="n">c_conf</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bounds</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">))</span>
            <span class="n">type2_stats</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">confidence</span><span class="o">=</span><span class="n">c_conf</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                <span class="n">auroc2</span><span class="o">=</span><span class="n">type2roc</span><span class="p">(</span><span class="n">accuracy</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">c_conf</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span>
                <span class="n">mratio</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">M_ratio</span>
            <span class="p">)</span>
            <span class="n">simargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">type2_stats</span><span class="o">=</span><span class="n">type2_stats</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;type2_criteria&#39;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                <span class="n">params_extra</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="c1"># type2_criteria_absolute=[np.sum(params[&#39;type2_criteria&#39;][:i + 1]) for i in range(len(params[&#39;type2_criteria&#39;]))],</span>
                    <span class="c1"># type2_criteria_bias=np.mean(params[&#39;type2_criteria&#39;]) * (len(params[&#39;type2_criteria&#39;]) + 1) - 1</span>
                    <span class="n">type2_criteria_bias</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span>
                    <span class="n">type2_criteria_confidence_bias</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;type2_criteria&#39;</span><span class="p">]),</span>
                    <span class="c1"># type2_criteria_bias_mult=np.mean(params[&#39;type2_criteria&#39;]) / 0.5,</span>
                    <span class="c1"># type2_criteria_confidence_bias_mult=0.5 / np.mean(params[&#39;type2_criteria&#39;]),</span>
                    <span class="c1"># type2_criteria_absdev=round(np.abs(np.array(params[&#39;type2_criteria&#39;]) -</span>
                    <span class="c1">#    np.arange(1/cfg._n_conf_levels, 1-1e-10, 1/cfg._n_conf_levels)).mean(), 10)</span>
                <span class="p">)</span>
                <span class="n">simargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params_extra</span><span class="o">=</span><span class="n">params_extra</span><span class="p">)</span>


    <span class="n">simulation</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="o">**</span><span class="n">simargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbosity</span><span class="p">:</span>
        <span class="n">print_dataset_characteristics</span><span class="p">(</span><span class="n">simulation</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">simulation</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="simulation">Simulation</h2>


<div class="doc doc-object doc-class">




    <div class="doc doc-contents first">



        <p>Class to store simulated data.
This class is created by the <code>remeta.simulation.simulate()</code>. Manual creation is discouraged.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nsubjects</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of subjects</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nsamples</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples per subject</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of model parameters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params_extra</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary of extra parameters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg</code>
            </td>
            <td>
                  <code><span title="remeta.configuration.Configuration">Configuration</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>remeta.configuration.Configuration</code> instance</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_stim</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>stimuli (array or list of signed stimulus intensities) (x)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_stim_category</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>stimulus category</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d_dec</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>choices (D)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_decval_latent</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>latent, i.e. noise-free decision values</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_decval</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>observed decision values (hat{y})</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z1_type1_evidence_latent</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>latent, i.e. noise-free type 1 evidence (z_1)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z1_type1_evidence_base</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>absolute values of observed decision values (|hat{y}|)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z1_type1_evidence</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>observed type 1 evidence (z2=hat{z_1})</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_conf_latent</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>probability correct based on z1_type1_evidence_latent</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_conf_base</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>probability correct based on z1_type1_evidence_base</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_conf</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>probability correct based on z1_type1_evidence</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>type1_stats</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>descriptive type 1 statistics</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>type2_stats</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>descriptive type 2 statistics</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>remeta/simulation.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Simulation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to store simulated data.</span>
<span class="sd">    This class is created by the `remeta.simulation.simulate()`. Manual creation is discouraged.</span>

<span class="sd">    Args:</span>
<span class="sd">        nsubjects: Number of subjects</span>
<span class="sd">        nsamples: Number of samples per subject</span>
<span class="sd">        params: Dictionary of model parameters</span>
<span class="sd">        params_extra: Optional dictionary of extra parameters</span>
<span class="sd">        cfg: `remeta.configuration.Configuration` instance</span>
<span class="sd">        x_stim: stimuli (array or list of signed stimulus intensities) (x)</span>
<span class="sd">        x_stim_category: stimulus category</span>
<span class="sd">        d_dec: choices (D)</span>
<span class="sd">        y_decval_latent: latent, i.e. noise-free decision values</span>
<span class="sd">        y_decval: observed decision values (hat{y})</span>
<span class="sd">        z1_type1_evidence_latent: latent, i.e. noise-free type 1 evidence (z_1)</span>
<span class="sd">        z1_type1_evidence_base: absolute values of observed decision values (|hat{y}|)</span>
<span class="sd">        z1_type1_evidence: observed type 1 evidence (z2=hat{z_1})</span>
<span class="sd">        c_conf_latent: probability correct based on z1_type1_evidence_latent</span>
<span class="sd">        c_conf_base: probability correct based on z1_type1_evidence_base</span>
<span class="sd">        c_conf: probability correct based on z1_type1_evidence</span>
<span class="sd">        type1_stats: descriptive type 1 statistics</span>
<span class="sd">        type2_stats: descriptive type 2 statistics</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">nsubjects</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">nsamples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">params_extra</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cfg</span><span class="p">:</span> <span class="n">Configuration</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">x_stim</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">x_stim_category</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">d_dec</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">y_decval_latent</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">y_decval</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">z1_type1_evidence_latent</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">z1_type1_evidence_base</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">z1_type1_evidence</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">c_conf_latent</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">c_conf_base</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">c_conf</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">type1_stats</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">type2_stats</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nsubjects</span> <span class="o">=</span> <span class="n">nsubjects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nsamples</span> <span class="o">=</span> <span class="n">nsamples</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_type1</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;type1_&#39;</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_type2</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;type2_&#39;</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_extra</span> <span class="o">=</span> <span class="n">params_extra</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stimuli</span> <span class="o">=</span> <span class="n">x_stim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stimuli_category</span> <span class="o">=</span> <span class="n">x_stim_category</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="n">d_dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accuracy</span> <span class="o">=</span> <span class="n">x_stim_category</span> <span class="o">==</span> <span class="n">d_dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_decval_latent</span> <span class="o">=</span> <span class="n">y_decval_latent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_decval</span> <span class="o">=</span> <span class="n">y_decval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1_type1_evidence_latent</span> <span class="o">=</span> <span class="n">z1_type1_evidence_latent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1_type1_evidence_base</span> <span class="o">=</span> <span class="n">z1_type1_evidence_base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1_type1_evidence</span> <span class="o">=</span> <span class="n">z1_type1_evidence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_latent</span> <span class="o">=</span> <span class="n">c_conf_latent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_base</span> <span class="o">=</span> <span class="n">c_conf_base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence</span> <span class="o">=</span> <span class="n">c_conf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type1_stats</span> <span class="o">=</span> <span class="n">type1_stats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type2_stats</span> <span class="o">=</span> <span class="n">type2_stats</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># for var in (&#39;x_stim&#39;, &#39;x_stim_category&#39;, &#39;d_dec&#39;, &#39;accuracy&#39;):</span>
        <span class="c1">#     if getattr(self, var) is not None:</span>
        <span class="c1">#         setattr(self, var, getattr(self, var).squeeze())</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_psychometric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">remeta</span>
        <span class="n">remeta</span><span class="o">.</span><span class="n">plot_psychometric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_stimulus_versus_confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">remeta</span>
        <span class="n">remeta</span><span class="o">.</span><span class="n">plot_stimulus_versus_confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_confidence_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">remeta</span>
        <span class="n">remeta</span><span class="o">.</span><span class="n">plot_confidence_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.expand"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../javascripts/external-tabs.js"></script>
      
    
  </body>
</html>