{"version":3,"kind":"Notebook","sha256":"92cb6dcd37e7f52fcc8caab3a21ec4cc94d59a6a1ac78777d192e7ed602666f5","slug":"visualize-nonlinear-encoding","location":"/content/visualize_nonlinear_encoding.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"edit_url":null,"source_url":null,"exports":[{"format":"ipynb","filename":"visualize_nonlinear_encoding.ipynb","url":"/build/visualize_nonlinear_-d93d692ba2d5edc68e73053b440b9277.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"collapsed":true,"ExecuteTime":{"end_time":"2026-01-29T08:34:03.612971505Z","start_time":"2026-01-29T08:34:03.600839508Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import remeta\nfrom remeta.transform import compute_nonlinear_encoding as nonlinear_encoding, logistic\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import binned_statistic","key":"eWxeuQtDyk"},{"type":"outputs","id":"qvu-IYoD3agTF_VcFZNYd","children":[],"key":"gACYA4JkJR"}],"key":"lYSkSBnjbI"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2026-01-29T08:34:03.660866816Z","start_time":"2026-01-29T08:34:03.614250545Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"np.random.seed(1)","key":"yqA4fJHQcQ"},{"type":"outputs","id":"yjvIhhon9cZYcvGS3vKW7","children":[],"key":"bCB9HiAYIR"}],"key":"t4mUB0irrE"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2026-01-29T08:41:07.761610320Z","start_time":"2026-01-29T08:41:07.714750896Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"nsamples = 100000\ngains = [-0.88, -0.5, -0.25, -0.1, 0, 0.5, 1, 2, 4]\nx = np.arange(-1, 1, 0.001)\n\nparams = dict(\n    type1_noise=0.5,\n    type1_bias=0,\n    type1_nonlinear_encoding_gain=1\n)\ncfg = remeta.Configuration()\ncfg.skip_type2 = True\ncfg.enable_param_type1_nonlinear_encoding_gain = 1\ncfg.type2_noise_dist = 'truncated_norm_mode'","key":"O1JlDLDKHC"},{"type":"outputs","id":"OjcboQ9VECOI44BXDhgsZ","children":[],"key":"HMDx7bqRUF"}],"key":"vABHX1qguh"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2026-01-29T08:34:03.770945208Z","start_time":"2026-01-29T08:34:03.711924990Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"d = remeta.simu_data(nsubjects=1, nsamples=nsamples, params=params, cfg=cfg, x_stim_external=None, verbosity=True,\n                     squeeze=True, compute_stats=True)","key":"jFvMLRPBnM"},{"type":"outputs","id":"-vurMXjS52KulMdj1l8Nx","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"----------------------------------\n..Generative parameters:\n    type1_noise: 0.5\n    type1_bias: 0\n    type1_nonlinear_encoding_gain: 1\n..Descriptive statistics:\n    No. subjects: 1\n    No. samples: 100000\n    Performance: 84.6% correct\n    Choice bias: -0.1%\n----------------------------------\n"},"children":[],"key":"l5CLpYABIE"}],"key":"EqqEVHrPDV"}],"key":"NDXAGUEKuo"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2026-01-29T08:40:06.744961828Z","start_time":"2026-01-29T08:40:06.601696111Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure()\n# plt.plot(d.stimuli, d.y_decval, 'o')\n\nedges = np.arange(np.min(d.stimuli), np.max(d.stimuli) + 0.1, 0.1)\nmean, sd = [binned_statistic(d.stimuli, d.choices, statistic=stat, bins=edges)[0] for stat in ('mean', 'std')]\ncenters = (edges[:-1] + edges[1:]) / 2\n\nplt.errorbar(centers, mean, yerr=sd, fmt=\"o-\", capsize=3)\n\n# plt.plot([-1, 1], [0, 1], 'k--')\nplt.plot(x, logistic(x, params['type1_noise']), 'k--')\nplt.plot([0, 0], [-2, 2], 'k', lw=0.75)\nplt.plot([-1, 1], [0.5, 0.5], 'k', lw=0.75)\nplt.xlim(-1, 1)\nplt.ylim(-0.5, 1.5)","key":"xQcfmNStus"},{"type":"outputs","id":"9IeRWtvFpFubP1wNgbzx3","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"(-0.5, 1.5)","content_type":"text/plain"}}},"children":[],"key":"DTNGCOlA7a"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1e9ef9737a60d485705dc05a27e64a36","path":"/build/1e9ef9737a60d485705dc05a27e64a36.png"}}},"children":[],"key":"kQ2ihUbwpG"}],"key":"j4GU3oaxSC"}],"key":"rGqWKUI8u6"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2026-01-29T08:41:12.399810953Z","start_time":"2026-01-29T08:41:12.354620668Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"colors = plt.get_cmap('gnuplot')(np.linspace(0, 1, len(gains)))\ncolors.shape","key":"tx1RX5dYWN"},{"type":"outputs","id":"Nki0uL5gAgaNqRxzJoLwY","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"(9, 4)","content_type":"text/plain"}}},"children":[],"key":"oMa29U1RnJ"}],"key":"ZRMIcvY523"}],"key":"U73vCRQKSu"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2026-01-29T08:41:13.423927980Z","start_time":"2026-01-29T08:41:13.195212620Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure()\ncolors = plt.get_cmap('gnuplot')(np.linspace(0, 1, int(len(gains)/2)+1))\ncolors = np.vstack((colors[1:][::-1], colors))\nfor i, gain in enumerate(gains):\n    plt.plot(x, nonlinear_encoding(x, type1_nonlinear_encoding_gain=gain), label=f'{gain}', color=colors[i], ls=':' if gain < 0 else ('--' if gain == 0 else '-'))\nplt.plot([0, 0], [-2, 2], 'k', lw=0.75)\nplt.plot([-1, 1], [0, 0], 'k', lw=0.75)\nplt.xlim(-1, 1)\nplt.ylim(-2, 2)\nplt.legend(title='Gain', bbox_to_anchor=(-0.2, 0.5), loc='center')","key":"mpoczwH3rf"},{"type":"outputs","id":"WasdfklLRyuOTf62S1Q5L","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5c3a547fdfe3273986b1f802e700f1d6","path":"/build/5c3a547fdfe3273986b1f802e700f1d6.png"}}},"children":[],"key":"olOtWzpj7W"}],"key":"kZE15eHSxs"}],"key":"Y48OE50xgK"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2026-01-29T08:54:49.949278511Z","start_time":"2026-01-29T08:54:49.745622868Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure()\nx = np.arange(-1, 1, 0.001)\ngains = [-0.88, -0.5, -0.25, -0.1, 0, 0.5, 1, 2, 4]\ncolors = plt.get_cmap('gnuplot')(np.linspace(0, 1, int(len(gains)/2)+1))\ncolors = np.vstack((colors[1:][::-1], colors))\nfor i, gain in enumerate(gains):\n    plt.plot(x, logistic(nonlinear_encoding(x, type1_nonlinear_encoding_gain=gain), params['type1_noise']), label=f'{gain}', color=colors[i], ls=':' if gain < 0 else ('--' if gain == 0 else '-'))\nplt.plot(x, logistic(x, params['type1_noise']), 'k--')\nplt.plot([0, 0], [0, 1], 'k', lw=0.75)\nplt.plot([-1, 1], [0.5, 0.5], 'k', lw=0.75)\nplt.xlim(-1, 1)\nplt.ylim(0, 1)\nplt.ylabel('Choice probability')\nplt.legend(title='Gain', bbox_to_anchor=(-0.2, 0.5), loc='center')","key":"ADr99Sv3Gr"},{"type":"outputs","id":"aYRmSQX8MlspkUYgMqC4S","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"a20a52048bc7c4ad6ffd85e738a034d2","path":"/build/a20a52048bc7c4ad6ffd85e738a034d2.png"}}},"children":[],"key":"chF81Ghkjo"}],"key":"fSEV4CPxKc"}],"key":"oY7pclhiu2"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2026-01-29T09:17:39.895985067Z","start_time":"2026-01-29T09:17:39.720103036Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure()\nx = np.arange(-1, 1, 0.001)\ntransitions = [0.1, 1, 2]\ncolors = plt.get_cmap('gnuplot')(np.linspace(0, 1, len(transitions)))[::-1]\nfor i, transition in enumerate(transitions):\n    plt.plot(x, nonlinear_encoding(x, type1_nonlinear_encoding_gain=1, type1_nonlinear_encoding_transition=transition), label=f'{transition}', color=colors[i])\nplt.plot([-1, 1], [-1, 1], 'k--')\nplt.plot([0, 0], [-2, 2], 'k', lw=0.75)\nplt.plot([-1, 1], [0, 0], 'k', lw=0.75)\nplt.xlim(-1, 1)\nplt.ylim(-2, 2)\nplt.legend(title='Transition')","key":"p9TDBRvNhI"},{"type":"outputs","id":"raBcfSHv-iDAnYgAlhyHv","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d9f67cb824390859e5b6c5d351e8a127","path":"/build/d9f67cb824390859e5b6c5d351e8a127.png"}}},"children":[],"key":"e3TzymvtHy"}],"key":"jnfNmZHE1I"}],"key":"BGVbHGM7hQ"}],"key":"FvqF8Kcg31"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Getting started","url":"/start","group":"â†’ API"}}},"domain":"http://localhost:3000"}